<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>mysql,约束多表，事务，JDBC整理的学习笔记</title>
      <link href="posts/4b3510a4.html"/>
      <url>posts/4b3510a4.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><hr><h4 id="数据库的基本概念"><a href="#数据库的基本概念" class="headerlink" title="数据库的基本概念"></a>数据库的基本概念</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">1</span>. 数据库的英文单词： DataBase 简称 ： DB    <span class="token number">2</span>. 什么数据库？        用于存储和管理数据的仓库。    <span class="token number">3</span>. 数据库的特点：    <span class="token number">1</span>. 持久化存储数据的。其实数据库就是一个文件系统    <span class="token number">2</span>. 方便存储和管理数据    <span class="token number">3</span>. 使用了统一的方式操作数据库 -- SQL<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>配置</p><h4 id="MySQL服务启动"><a href="#MySQL服务启动" class="headerlink" title="MySQL服务启动"></a>MySQL服务启动</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">``<span class="token variable"><span class="token variable">`</span><span class="token function">bash</span>     <span class="token number">1</span>. 手动。     <span class="token number">2</span>. cmd--<span class="token operator">&gt;</span> services.msc 打开服务的窗口     <span class="token number">3</span>. 使用管理员打开cmd         * net start mysql <span class="token builtin class-name">:</span> 启动mysql的服务         * net stop mysql:关闭mysql服务<span class="token variable">`</span></span>``<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="MySQL登录"><a href="#MySQL登录" class="headerlink" title="MySQL登录"></a>MySQL登录</h4><p>​           <code>bash ​            1. mysql -uroot -p密码 ​            2. mysql -hip -uroot -p连接目标的密码 ​            3. mysql --host=ip --user=root --password=连接目标的密码 ​        * MySQL退出 ​            1. exit ​            2. quit ​           </code><br> MySQL目录结构<br>​            <code>bash ​            1. MySQL安装目录：basedir="D:/develop/MySQL/" ​                * 配置文件 my.ini ​            2. MySQL数据目录：datadir="C:/ProgramData/MySQL/MySQL Server 5.5/Data/" ​                * 几个概念 ​                    * 数据库：文件夹 ​                    * 表：文件 ​                    * 数据：数据 ​            </code></p><h4 id="SQL"><a href="#SQL" class="headerlink" title="SQL"></a>SQL</h4> <pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">1</span>.什么是SQL？        Structured Query Language：结构化查询语言        其实就是定义了操作所有关系型数据库的规则。每一种数据库操作的方式存在不一样的地方，称为“方言”。        <span class="token number">2</span>.SQL通用语法        <span class="token number">1</span>. SQL 语句可以单行或多行书写，以分号结尾。        <span class="token number">2</span>. 可使用空格和缩进来增强语句的可读性。        <span class="token number">3</span>. MySQL 数据库的 SQL 语句不区分大小写，关键字建议使用大写。        <span class="token number">4</span>. <span class="token number">3</span> 种注释            * 单行注释: -- 注释内容 或 <span class="token comment"># 注释内容(mysql 特有) </span>            * 多行注释: /* 注释 */        <span class="token number">3</span>. SQL分类        <span class="token number">1</span><span class="token punctuation">)</span> DDL<span class="token punctuation">(</span>Data Definition Language<span class="token punctuation">)</span>数据定义语言            用来定义数据库对象：数据库，表，列等。关键字：create, drop,alter 等        <span class="token number">2</span><span class="token punctuation">)</span> DML<span class="token punctuation">(</span>Data Manipulation Language<span class="token punctuation">)</span>数据操作语言            用来对数据库中表的数据进行增删改。关键字：insert, delete, update 等        <span class="token number">3</span><span class="token punctuation">)</span> DQL<span class="token punctuation">(</span>Data Query Language<span class="token punctuation">)</span>数据查询语言            用来查询数据库中表的记录<span class="token punctuation">(</span>数据<span class="token punctuation">)</span>。关键字：select, where 等        <span class="token number">4</span><span class="token punctuation">)</span> DCL<span class="token punctuation">(</span>Data Control Language<span class="token punctuation">)</span>数据控制语言<span class="token punctuation">(</span>了解<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="DDL"><a href="#DDL" class="headerlink" title="DDL"></a>DDL</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">1</span>. 操作数据库：CRUD        <span class="token number">1</span>. C<span class="token punctuation">(</span>Create<span class="token punctuation">)</span>:创建            创建数据库：                            * create database 数据库名称<span class="token punctuation">;</span>* 创建数据库，判断不存在，再创建：       * create database <span class="token keyword">if</span> not exists 数据库名称<span class="token punctuation">;</span>* 创建数据库，并指定字符集                 * create database 数据库名称 character <span class="token builtin class-name">set</span> 字符集名<span class="token punctuation">;</span>* 创建aaa数据库，判断是否存在，并制定字符集为gbk                * create database <span class="token keyword">if</span> not exists aaa character <span class="token builtin class-name">set</span> gbk<span class="token punctuation">;</span>               <span class="token number">2</span>. R<span class="token punctuation">(</span>Retrieve<span class="token punctuation">)</span>：查询            * 查询所有数据库的名称:          * show databases<span class="token punctuation">;</span>                            * 查询某个数据库的字符集:查询某个数据库的创建语句                             * show create database 数据库名称<span class="token punctuation">;</span>              <span class="token number">3</span>. U<span class="token punctuation">(</span>Update<span class="token punctuation">)</span>:修改            * 修改数据库的字符集                            * alter database 数据库名称 character <span class="token builtin class-name">set</span> 字符集名称<span class="token punctuation">;</span><span class="token number">4</span>. D<span class="token punctuation">(</span>Delete<span class="token punctuation">)</span>:删除            * 删除数据库                             * drop database 数据库名称<span class="token punctuation">;</span>                          * 判断数据库存在，存在再删除h                             * drop database <span class="token keyword">if</span> exists 数据库名称<span class="token punctuation">;</span>                <span class="token number">5</span>. 使用数据库            * 查询当前正在使用的数据库名称                             * <span class="token keyword">select</span> database<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                            * 使用数据库                            * use 数据库名称<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="操作表"><a href="#操作表" class="headerlink" title="操作表"></a>操作表</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">一. C<span class="token punctuation">(</span>Create<span class="token punctuation">)</span>:创建 <span class="token number">1</span>. 语法：create table 表名<span class="token punctuation">(</span>                    列名1 数据类型1,                    列名2 数据类型2,                    <span class="token punctuation">..</span><span class="token punctuation">..</span>                    列名n 数据类型n                <span class="token punctuation">)</span><span class="token punctuation">;</span>* 注意：最后一列，不需要加逗号（,）* 数据库类型：            <span class="token number">1</span>. int：整数类型                 * age int,             <span class="token number">2</span>. double:小数类型                 * score double<span class="token punctuation">(</span><span class="token number">5,2</span><span class="token punctuation">)</span>             <span class="token number">3</span>. date:日期，只包含年月日，yyyy-MM-dd             <span class="token number">4</span>. datetime:日期，包含年月日时分秒  yyyy-MM-dd HH:mm:ss             <span class="token number">5</span>. timestamp:时间错类型  包含年月日时分秒     yyyy-MM-dd HH:mm:ss                            * 如果将来不给这个字段赋值，或赋值为null，则默认使用当前的系统时间，来自动赋值            <span class="token number">6</span>. varchar：字符串                        * name varchar<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>:姓名最大20个字符                        * zhangsan <span class="token number">8</span>个字符  张三 <span class="token number">2</span>个字符               二.建表                create table student<span class="token punctuation">(</span>                    <span class="token function">id</span> int,                    name varchar<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span>,                    age int ,                    score double<span class="token punctuation">(</span><span class="token number">4,1</span><span class="token punctuation">)</span>,                    birthday date,                    insert_time timestamp                <span class="token punctuation">)</span><span class="token punctuation">;</span>            * 复制表：                * create table 表名 like 被复制的表名<span class="token punctuation">;</span>       <span class="token number">2</span>. R<span class="token punctuation">(</span>Retrieve<span class="token punctuation">)</span>：查询            * 查询某个数据库中所有的表名称                * show tables<span class="token punctuation">;</span>            * 查询表结构                * desc 表名<span class="token punctuation">;</span>                 <span class="token number">3</span>. U<span class="token punctuation">(</span>Update<span class="token punctuation">)</span>:修改                   <span class="token number">1</span>. 修改表名                alter table 表名 <span class="token function">rename</span> to 新的表名<span class="token punctuation">;</span>            <span class="token number">2</span>. 修改表的字符集                alter table 表名 character <span class="token builtin class-name">set</span> 字符集名称<span class="token punctuation">;</span>            <span class="token number">3</span>. 添加一列                alter table 表名 <span class="token function">add</span> 列名 数据类型<span class="token punctuation">;</span>            <span class="token number">4</span>. 修改列名称 类型                alter table 表名 change 列名 新列别 新数据类型<span class="token punctuation">;</span>                alter table 表名 modify 列名 新数据类型<span class="token punctuation">;</span>            <span class="token number">5</span>. 删除列                alter table 表名 drop 列名<span class="token punctuation">;</span>                D<span class="token punctuation">(</span>Delete<span class="token punctuation">)</span>:删除            * drop table 表名<span class="token punctuation">;</span>            * drop table  <span class="token keyword">if</span> exists 表名 <span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="DML"><a href="#DML" class="headerlink" title="DML"></a>DML</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">1</span>. 添加数据：        * 语法：            * insert into 表名<span class="token punctuation">(</span>列名1,列名2,<span class="token punctuation">..</span>.列名n<span class="token punctuation">)</span> values<span class="token punctuation">(</span>值1,值2,<span class="token punctuation">..</span>.值n<span class="token punctuation">)</span><span class="token punctuation">;</span>        * 注意：            <span class="token number">1</span>. 列名和值要一一对应。            <span class="token number">2</span>. 如果表名后，不定义列名，则默认给所有列添加值                insert into 表名 values<span class="token punctuation">(</span>值1,值2,<span class="token punctuation">..</span>.值n<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token number">3</span>. 除了数字类型，其他类型需要使用引号<span class="token punctuation">(</span>单双都可以<span class="token punctuation">)</span>引起来 <span class="token number">2</span>. 删除数据：        * 语法：            * delete from 表名 <span class="token punctuation">[</span>where 条件<span class="token punctuation">]</span>        * 注意：            <span class="token number">1</span>. 如果不加条件，则删除表中所有记录。            <span class="token number">2</span>. 如果要删除所有记录                <span class="token number">1</span>. delete from 表名<span class="token punctuation">;</span> -- 不推荐使用。有多少条记录就会执行多少次删除操作                <span class="token number">2</span>. TRUNCATE TABLE 表名<span class="token punctuation">;</span> -- 推荐使用，效率更高 先删除表，然后再创建一张一样的表。    <span class="token number">3</span>. 修改数据：        * 语法：            * update 表名 <span class="token builtin class-name">set</span> 列名1 <span class="token operator">=</span> 值1, 列名2 <span class="token operator">=</span> 值2,<span class="token punctuation">..</span>. <span class="token punctuation">[</span>where 条件<span class="token punctuation">]</span><span class="token punctuation">;</span>        * 注意：            <span class="token number">1</span>. 如果不加任何条件，则会将表中所有记录全部修改。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="DQL：查询表中的记录"><a href="#DQL：查询表中的记录" class="headerlink" title="DQL：查询表中的记录"></a>DQL：查询表中的记录</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">    * <span class="token keyword">select</span> * from 表名<span class="token punctuation">;</span> <span class="token number">1</span>. 语法：        <span class="token keyword">select</span>            字段列表        from            表名列表        where            条件列表        group by            分组字段        having            分组之后的条件        order by            排序        limit            分页限定<span class="token number">2</span>. 基础查询        <span class="token number">1</span>. 多个字段的查询            <span class="token keyword">select</span> 字段名1，字段名2<span class="token punctuation">..</span>. from 表名；            * 注意：                * 如果查询所有字段，则可以使用*来替代字段列表。        <span class="token number">2</span>. 去除重复：            * distinct        <span class="token number">3</span>. 计算列            * 一般可以使用四则运算计算一些列的值。（一般只会进行数值型的计算）            * ifnull<span class="token punctuation">(</span>表达式1,表达式2<span class="token punctuation">)</span>：null参与的运算，计算结果都为null                * 表达式1：哪个字段需要判断是否为null                * 如果该字段为null后的替换值。        <span class="token number">4</span>. 起别名：            * as：as也可以省略                        条件查询        <span class="token number">1</span>. where子句后跟条件        <span class="token number">2</span>. 运算符            * <span class="token operator">&gt;</span> 、<span class="token operator">&lt;</span> 、<span class="token operator">&lt;</span><span class="token operator">=</span> 、<span class="token operator">&gt;</span><span class="token operator">=</span> 、<span class="token operator">=</span> 、<span class="token operator">&lt;&gt;</span>            * BETWEEN<span class="token punctuation">..</span>.AND              * IN<span class="token punctuation">(</span> 集合<span class="token punctuation">)</span>             * LIKE：模糊查询                * 占位符：                    * _:单个任意字符                    * %：多个任意字符            * IS NULL              * and  或 <span class="token operator">&amp;&amp;</span>            * or  或 <span class="token operator">||</span>             * not  或 <span class="token operator">!</span>                            -- 查询年龄大于20岁                SELECT * FROM student WHERE age <span class="token operator">&gt;</span> <span class="token number">20</span><span class="token punctuation">;</span>                                SELECT * FROM student WHERE age <span class="token operator">&gt;</span><span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>                                -- 查询年龄等于20岁                SELECT * FROM student WHERE age <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>                                -- 查询年龄不等于20岁                SELECT * FROM student WHERE age <span class="token operator">!=</span> <span class="token number">20</span><span class="token punctuation">;</span>                SELECT * FROM student WHERE age <span class="token operator">&lt;&gt;</span> <span class="token number">20</span><span class="token punctuation">;</span>                                -- 查询年龄大于等于20 小于等于30                                SELECT * FROM student WHERE age <span class="token operator">&gt;</span><span class="token operator">=</span> <span class="token number">20</span> <span class="token operator">&amp;&amp;</span>  age <span class="token operator">&lt;</span><span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">;</span>                SELECT * FROM student WHERE age <span class="token operator">&gt;</span><span class="token operator">=</span> <span class="token number">20</span> AND  age <span class="token operator">&lt;</span><span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">;</span>                SELECT * FROM student WHERE age BETWEEN <span class="token number">20</span> AND <span class="token number">30</span><span class="token punctuation">;</span>                                -- 查询年龄22岁，18岁，25岁的信息                SELECT * FROM student WHERE age <span class="token operator">=</span> <span class="token number">22</span> OR age <span class="token operator">=</span> <span class="token number">18</span> OR age <span class="token operator">=</span> <span class="token number">25</span>                SELECT * FROM student WHERE age IN <span class="token punctuation">(</span><span class="token number">22,18</span>,25<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="DQL-查询语句"><a href="#DQL-查询语句" class="headerlink" title="DQL:查询语句"></a>DQL:查询语句</h4><ol><li><p>排序查询</p><p>语法：order by 子句</p><p>order by 排序字段1 排序方式1 ，  排序字段2 排序方式2…</p></li></ol><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">排序方式：* ASC：升序，默认的。* DESC：降序。注意：* 如果有多个排序条件，则当前边的条件值一样时，才会判断第二条件。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">2</span>. 聚合函数：将一列数据作为一个整体，进行纵向的计算。<span class="token number">1</span>. count：计算个数<span class="token number">1</span>. 一般选择非空的列：主键<span class="token number">2</span>. count<span class="token punctuation">(</span>*<span class="token punctuation">)</span><span class="token number">2</span>. max：计算最大值<span class="token number">3</span>. min：计算最小值<span class="token number">4</span>. sum：计算和<span class="token number">5</span>. avg：计算平均值<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">注意：聚合函数的计算，排除null值。解决方案：<span class="token number">1</span>. 选择不包含非空的列进行计算<span class="token number">2</span>. IFNULL函数<span class="token number">3</span>. 分组查询:<span class="token number">1</span>. 语法：group by 分组字段；<span class="token number">2</span>. 注意：<span class="token number">1</span>. 分组之后查询的字段：分组字段、聚合函数<span class="token number">2</span>. where 和 having 的区别？<span class="token number">1</span>. where 在分组之前进行限定，如果不满足条件，则不参与分组。having在分组之后进行限定，如果不满足结果，则不会被查询出来<span class="token number">2</span>. where 后不可以跟聚合函数，having可以进行聚合函数的判断。-- 按照性别分组。分别查询男、女同学的平均分SELECT sex , AVG<span class="token punctuation">(</span>math<span class="token punctuation">)</span> FROM student GROUP BY sex<span class="token punctuation">;</span>-- 按照性别分组。分别查询男、女同学的平均分,人数SELECT sex , AVG<span class="token punctuation">(</span>math<span class="token punctuation">)</span>,COUNT<span class="token punctuation">(</span>id<span class="token punctuation">)</span> FROM student GROUP BY sex<span class="token punctuation">;</span>--  按照性别分组。分别查询男、女同学的平均分,人数 要求：分数低于70分的人，不参与分组SELECT sex , AVG<span class="token punctuation">(</span>math<span class="token punctuation">)</span>,COUNT<span class="token punctuation">(</span>id<span class="token punctuation">)</span> FROM student WHERE math <span class="token operator">&gt;</span> <span class="token number">70</span> GROUP BY sex<span class="token punctuation">;</span>--  按照性别分组。分别查询男、女同学的平均分,人数 要求：分数低于70分的人，不参与分组,分组之后。人数要大于2个人SELECT sex , AVG<span class="token punctuation">(</span>math<span class="token punctuation">)</span>,COUNT<span class="token punctuation">(</span>id<span class="token punctuation">)</span> FROM student WHERE math <span class="token operator">&gt;</span> <span class="token number">70</span> GROUP BY sex HAVING COUNT<span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">2</span><span class="token punctuation">;</span>SELECT sex , AVG<span class="token punctuation">(</span>math<span class="token punctuation">)</span>,COUNT<span class="token punctuation">(</span>id<span class="token punctuation">)</span> 人数 FROM student WHERE math <span class="token operator">&gt;</span> <span class="token number">70</span> GROUP BY sex HAVING 人数 <span class="token operator">&gt;</span> <span class="token number">2</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>​            </p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">4</span>. 分页查询<span class="token number">1</span>. 语法：limit 开始的索引,每页查询的条数<span class="token punctuation">;</span><span class="token number">2</span>. 公式：开始的索引 <span class="token operator">=</span> （当前的页码 - <span class="token number">1</span>） * 每页显示的条数-- 每页显示3条记录 SELECT * FROM student LIMIT <span class="token number">0,3</span><span class="token punctuation">;</span> -- 第1页SELECT * FROM student LIMIT <span class="token number">3,3</span><span class="token punctuation">;</span> -- 第2页SELECT * FROM student LIMIT <span class="token number">6,3</span><span class="token punctuation">;</span> -- 第3页<span class="token number">3</span>. limit 是一个MySQL<span class="token string">"方言"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="约束"><a href="#约束" class="headerlink" title="约束"></a>约束</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">* 概念： 对表中的数据进行限定，保证数据的正确性、有效性和完整性。* 分类：<span class="token number">1</span>. 主键约束：primary key<span class="token number">2</span>. 非空约束：not null<span class="token number">3</span>. 唯一约束：unique<span class="token number">4</span>. 外键约束：foreign key* 非空约束：not null，某一列的值不能为null<span class="token number">1</span>. 创建表时添加约束CREATE TABLE stu<span class="token punctuation">(</span><span class="token function">id</span> INT,NAME VARCHAR<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> NOT NULL -- name为非空<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token number">2</span>. 创建表完后，添加非空约束ALTER TABLE stu MODIFY NAME VARCHAR<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> NOT NULL<span class="token punctuation">;</span><span class="token number">3</span>. 删除name的非空约束ALTER TABLE stu MODIFY NAME VARCHAR<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>* 唯一约束：unique，某一列的值不能重复<span class="token number">1</span>. 注意：* 唯一约束可以有NULL值，但是只能有一条记录为null<span class="token number">2</span>. 在创建表时，添加唯一约束CREATE TABLE stu<span class="token punctuation">(</span><span class="token function">id</span> INT,phone_number VARCHAR<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> UNIQUE -- 手机号<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token number">3</span>. 删除唯一约束ALTER TABLE stu DROP INDEX phone_number<span class="token punctuation">;</span><span class="token number">4</span>. 在表创建完后，添加唯一约束ALTER TABLE stu MODIFY phone_number VARCHAR<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> UNIQUE<span class="token punctuation">;</span>* 主键约束：primary key。<span class="token number">1</span>. 注意：<span class="token number">1</span>. 含义：非空且唯一<span class="token number">2</span>. 一张表只能有一个字段为主键<span class="token number">3</span>. 主键就是表中记录的唯一标识<span class="token number">2</span>. 在创建表时，添加主键约束create table stu<span class="token punctuation">(</span><span class="token function">id</span> int primary key,-- 给id添加主键约束name varchar<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token number">3</span>. 删除主键-- 错误 alter table stu modify <span class="token function">id</span> int <span class="token punctuation">;</span>ALTER TABLE stu DROP PRIMARY KEY<span class="token punctuation">;</span><span class="token number">4</span>. 创建完表后，添加主键ALTER TABLE stu MODIFY <span class="token function">id</span> INT PRIMARY KEY<span class="token punctuation">;</span><span class="token number">5</span>. 自动增长：<span class="token number">1</span>.  概念：如果某一列是数值类型的，使用 auto_increment 可以来完成值得自动增长<span class="token number">2</span>. 在创建表时，添加主键约束，并且完成主键自增长create table stu<span class="token punctuation">(</span><span class="token function">id</span> int primary key auto_increment,-- 给id添加主键约束name varchar<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>​            </p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">3</span>. 删除自动增长ALTER TABLE stu MODIFY <span class="token function">id</span> INT<span class="token punctuation">;</span><span class="token number">4</span>. 添加自动增长ALTER TABLE stu MODIFY <span class="token function">id</span> INT AUTO_INCREMENT<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">* 外键约束：foreign key,让表于表产生关系，从而保证数据的正确性。<span class="token number">1</span>. 在创建表时，可以添加外键* 语法：create table 表名<span class="token punctuation">(</span><span class="token punctuation">..</span><span class="token punctuation">..</span>外键列constraint 外键名称 foreign key <span class="token punctuation">(</span>外键列名称<span class="token punctuation">)</span> references 主表名称<span class="token punctuation">(</span>主表列名称<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token number">2</span>. 删除外键ALTER TABLE 表名 DROP FOREIGN KEY 外键名称<span class="token punctuation">;</span><span class="token number">3</span>. 创建表之后，添加外键ALTER TABLE 表名 ADD CONSTRAINT 外键名称 FOREIGN KEY <span class="token punctuation">(</span>外键字段名称<span class="token punctuation">)</span> REFERENCES 主表名称<span class="token punctuation">(</span>主表列名称<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>​        </p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">4</span>. 级联操作<span class="token number">1</span>. 添加级联操作语法：ALTER TABLE 表名 ADD CONSTRAINT 外键名称 FOREIGN KEY <span class="token punctuation">(</span>外键字段名称<span class="token punctuation">)</span> REFERENCES 主表名称<span class="token punctuation">(</span>主表列名称<span class="token punctuation">)</span> ON UPDATE CASCADE ON DELETE CASCADE  <span class="token punctuation">;</span><span class="token number">2</span>. 分类：<span class="token number">1</span>. 级联更新：ON UPDATE CASCADE <span class="token number">2</span>. 级联删除：ON DELETE CASCADE <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="数据库的设计"><a href="#数据库的设计" class="headerlink" title="数据库的设计"></a>数据库的设计</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">1</span>. 多表之间的关系<span class="token number">1</span>. 分类：<span class="token number">1</span>. 一对一<span class="token punctuation">(</span>了解<span class="token punctuation">)</span>：* 如：人和身份证* 分析：一个人只有一个身份证，一个身份证只能对应一个人<span class="token number">2</span>. 一对多<span class="token punctuation">(</span>多对一<span class="token punctuation">)</span>：* 如：部门和员工* 分析：一个部门有多个员工，一个员工只能对应一个部门<span class="token number">3</span>. 多对多：* 如：学生和课程* 分析：一个学生可以选择很多门课程，一个课程也可以被很多学生选择<span class="token number">2</span>. 实现关系：<span class="token number">1</span>. 一对多<span class="token punctuation">(</span>多对一<span class="token punctuation">)</span>：* 如：部门和员工* 实现方式：在多的一方建立外键，指向一的一方的主键。<span class="token number">2</span>. 多对多：* 如：学生和课程* 实现方式：多对多关系实现需要借助第三张中间表。中间表至少包含两个字段，这两个字段作为第三张表的外键，分别指向两张表的主键<span class="token number">3</span>. 一对一<span class="token punctuation">(</span>了解<span class="token punctuation">)</span>：* 如：人和身份证* 实现方式：一对一关系实现，可以在任意一方添加唯一外键指向另一方的主键。<span class="token number">3</span>. 案例-- 创建旅游线路分类表 tab_category-- cid 旅游线路分类主键，自动增长-- cname 旅游线路分类名称非空，唯一，字符串 <span class="token number">100</span>CREATE TABLE tab_category <span class="token punctuation">(</span>cid INT PRIMARY KEY AUTO_INCREMENT,cname VARCHAR<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> NOT NULL UNIQUE<span class="token punctuation">)</span><span class="token punctuation">;</span>-- 创建旅游线路表 tab_route/*rid 旅游线路主键，自动增长rname 旅游线路名称非空，唯一，字符串 <span class="token number">100</span>price 价格rdate 上架时间，日期类型cid 外键，所属分类*/CREATE TABLE tab_route<span class="token punctuation">(</span>rid INT PRIMARY KEY AUTO_INCREMENT,rname VARCHAR<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> NOT NULL UNIQUE,price DOUBLE,rdate DATE,cid INT,FOREIGN KEY <span class="token punctuation">(</span>cid<span class="token punctuation">)</span> REFERENCES tab_category<span class="token punctuation">(</span>cid<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>/*创建用户表 tab_useruid 用户主键，自增长username 用户名长度 <span class="token number">100</span>，唯一，非空password 密码长度 <span class="token number">30</span>，非空name 真实姓名长度 <span class="token number">100</span>birthday 生日sex 性别，定长字符串 <span class="token number">1</span>telephone 手机号，字符串 <span class="token number">11</span>email 邮箱，字符串长度 <span class="token number">100</span>*/CREATE TABLE tab_user <span class="token punctuation">(</span>uid INT PRIMARY KEY AUTO_INCREMENT,username VARCHAR<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> UNIQUE NOT NULL,PASSWORD VARCHAR<span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span> NOT NULL,NAME VARCHAR<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>,birthday DATE,sex CHAR<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> DEFAULT <span class="token string">'男'</span>,telephone VARCHAR<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>,email VARCHAR<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>/*创建收藏表 tab_favoriterid 旅游线路 id，外键<span class="token function">date</span> 收藏时间uid 用户 id，外键rid 和 uid 不能重复，设置复合主键，同一个用户不能收藏同一个线路两次*/CREATE TABLE tab_favorite <span class="token punctuation">(</span>rid INT, -- 线路idDATE DATETIME,uid INT, -- 用户id-- 创建复合主键PRIMARY KEY<span class="token punctuation">(</span>rid,uid<span class="token punctuation">)</span>, -- 联合主键FOREIGN KEY <span class="token punctuation">(</span>rid<span class="token punctuation">)</span> REFERENCES tab_route<span class="token punctuation">(</span>rid<span class="token punctuation">)</span>,FOREIGN KEY<span class="token punctuation">(</span>uid<span class="token punctuation">)</span> REFERENCES tab_user<span class="token punctuation">(</span>uid<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>​        </p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">2</span>. 数据库设计的范式* 概念：设计数据库时，需要遵循的一些规范。要遵循后边的范式要求，必须先遵循前边的所有范式要求设计关系数据库时，遵从不同的规范要求，设计出合理的关系型数据库，这些不同的规范要求被称为不同的范式，各种范式呈递次规范，越高的范式数据库冗余越小。目前关系数据库有六种范式：第一范式（1NF）、第二范式（2NF）、第三范式（3NF）、巴斯-科德范式（BCNF）、第四范式<span class="token punctuation">(</span>4NF）和第五范式（5NF，又称完美范式）。* 分类：<span class="token number">1</span>. 第一范式（1NF）：每一列都是不可分割的原子数据项<span class="token number">2</span>. 第二范式（2NF）：在1NF的基础上，非码属性必须完全依赖于码（在1NF基础上消除非主属性对主码的部分函数依赖）* 几个概念：<span class="token number">1</span>. 函数依赖：A--<span class="token operator">&gt;</span>B,如果通过A属性<span class="token punctuation">(</span>属性组<span class="token punctuation">)</span>的值，可以确定唯一B属性的值。则称B依赖于A例如：学号--<span class="token operator">&gt;</span>姓名。  （学号，课程名称） --<span class="token operator">&gt;</span> 分数<span class="token number">2</span>. 完全函数依赖：A--<span class="token operator">&gt;</span>B， 如果A是一个属性组，则B属性值得确定需要依赖于A属性组中所有的属性值。例如：（学号，课程名称） --<span class="token operator">&gt;</span> 分数<span class="token number">3</span>. 部分函数依赖：A--<span class="token operator">&gt;</span>B， 如果A是一个属性组，则B属性值得确定只需要依赖于A属性组中某一些值即可。例如：（学号，课程名称） -- <span class="token operator">&gt;</span> 姓名<span class="token number">4</span>. 传递函数依赖：A--<span class="token operator">&gt;</span>B, B -- <span class="token operator">&gt;</span>C <span class="token builtin class-name">.</span> 如果通过A属性<span class="token punctuation">(</span>属性组<span class="token punctuation">)</span>的值，可以确定唯一B属性的值，在通过B属性（属性组）的值可以确定唯一C属性的值，则称 C 传递函数依赖于A例如：学号--<span class="token operator">&gt;</span>系名，系名--<span class="token operator">&gt;</span>系主任<span class="token number">5</span>. 码：如果在一张表中，一个属性或属性组，被其他所有属性所完全依赖，则称这个属性<span class="token punctuation">(</span>属性组<span class="token punctuation">)</span>为该表的码例如：该表中码为：（学号，课程名称）* 主属性：码属性组中的所有属性* 非主属性：除过码属性组的属性<span class="token number">3</span>. 第三范式（3NF）：在2NF基础上，任何非主属性不依赖于其它非主属性（在2NF基础上消除传递依赖）<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="数据库的备份和还原"><a href="#数据库的备份和还原" class="headerlink" title="数据库的备份和还原"></a>数据库的备份和还原</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">1</span>. 命令行：* 语法：* 备份： mysqldump -u用户名 -p密码 数据库名称 <span class="token operator">&gt;</span> 保存的路径* 还原：<span class="token number">1</span>. 登录数据库<span class="token number">2</span>. 创建数据库<span class="token number">3</span>. 使用数据库<span class="token number">4</span>. 执行文件。source 文件路径<span class="token number">2</span>. 图形化工具：<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="多表查询："><a href="#多表查询：" class="headerlink" title="多表查询："></a>多表查询：</h4><ul><li><p>查询语法：<br>  select<br>  列名列表<br>  from<br>  表名列表<br>  where….</p><ul><li><p>准备sql</p><h5 id="创建部门表"><a href="#创建部门表" class="headerlink" title="创建部门表"></a>创建部门表</h5><p>CREATE TABLE dept(</p><pre><code>id INT PRIMARY KEY AUTO_INCREMENT,NAME VARCHAR(20)</code></pre><p>);<br>INSERT INTO dept (NAME) VALUES (‘开发部’),(‘市场部’),(‘财务部’);</p><h5 id="创建员工表"><a href="#创建员工表" class="headerlink" title="创建员工表"></a>创建员工表</h5><p>CREATE TABLE emp (</p><pre><code>id INT PRIMARY KEY AUTO_INCREMENT,NAME VARCHAR(10),gender CHAR(1), -- 性别salary DOUBLE, -- 工资join_date DATE, -- 入职日期dept_id INT,FOREIGN KEY (dept_id) REFERENCES dept(id) -- 外键，关联部门表(部门表的主键)</code></pre><p>);<br>INSERT INTO emp(NAME,gender,salary,join_date,dept_id) VALUES(‘孙悟空’,’男’,7200,’2013-02-24’,1);<br>INSERT INTO emp(NAME,gender,salary,join_date,dept_id) VALUES(‘猪八戒’,’男’,3600,’2010-12-02’,2);<br>INSERT INTO emp(NAME,gender,salary,join_date,dept_id) VALUES(‘唐僧’,’男’,9000,’2008-08-08’,2);<br>INSERT INTO emp(NAME,gender,salary,join_date,dept_id) VALUES(‘白骨精’,’女’,5000,’2015-10-07’,3);<br>INSERT INTO emp(NAME,gender,salary,join_date,dept_id) VALUES(‘蜘蛛精’,’女’,4500,’2011-03-14’,1);</p><p>笛卡尔积：</p><p>有两个集合A,B .取这两个集合的所有组成情况。</p><p>要完成多表查询，需要消除无用的数据</p><p>多表查询的分类</p></li></ul></li></ul><pre><code>   1.内连接查询：   1. 隐式内连接：使用where条件消除无用数据       * 例子：       -- 查询所有员工信息和对应的部门信息</code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">SELECT * FROM emp,dept WHERE emp.<span class="token variable"><span class="token variable">`</span>dept_id<span class="token variable">`</span></span> <span class="token operator">=</span> dept.<span class="token variable"><span class="token variable">`</span><span class="token function">id</span><span class="token variable">`</span></span><span class="token punctuation">;</span>-- 查询员工表的名称，性别。部门表的名称SELECT emp.name,emp.gender,dept.name FROM emp,dept WHERE emp.<span class="token variable"><span class="token variable">`</span>dept_id<span class="token variable">`</span></span> <span class="token operator">=</span> dept.<span class="token variable"><span class="token variable">`</span><span class="token function">id</span><span class="token variable">`</span></span><span class="token punctuation">;</span>SELECT t1.name, -- 员工表的姓名t1.gender,-- 员工表的性别t2.name -- 部门表的名称FROMemp t1,dept t2WHERE t1.<span class="token variable"><span class="token variable">`</span>dept_id<span class="token variable">`</span></span> <span class="token operator">=</span> t2.<span class="token variable"><span class="token variable">`</span><span class="token function">id</span><span class="token variable">`</span></span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>​    </p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">2</span>. 显式内连接：* 语法： <span class="token keyword">select</span> 字段列表 from 表名1 <span class="token punctuation">[</span>inner<span class="token punctuation">]</span> <span class="token function">join</span> 表名2 on 条件* 例如：* SELECT * FROM emp INNER JOIN dept ON emp.<span class="token variable"><span class="token variable">`</span>dept_id<span class="token variable">`</span></span> <span class="token operator">=</span> dept.<span class="token variable"><span class="token variable">`</span><span class="token function">id</span><span class="token variable">`</span></span><span class="token punctuation">;</span>* SELECT * FROM emp JOIN dept ON emp.<span class="token variable"><span class="token variable">`</span>dept_id<span class="token variable">`</span></span> <span class="token operator">=</span> dept.<span class="token variable"><span class="token variable">`</span><span class="token function">id</span><span class="token variable">`</span></span><span class="token punctuation">;</span><span class="token number">3</span>. 内连接查询：<span class="token number">1</span>. 从哪些表中查询数据<span class="token number">2</span>. 条件是什么<span class="token number">3</span>. 查询哪些字段<span class="token number">2</span>. 外链接查询：<span class="token number">1</span>. 左外连接：* 语法：select 字段列表 from 表1 left <span class="token punctuation">[</span>outer<span class="token punctuation">]</span> <span class="token function">join</span> 表2 on 条件；* 查询的是左表所有数据以及其交集部分。* 例子：-- 查询所有员工信息，如果员工有部门，则查询部门名称，没有部门，则不显示部门名称SELECT t1.*,t2.<span class="token variable"><span class="token variable">`</span>name<span class="token variable">`</span></span> FROM emp t1 LEFT JOIN dept t2 ON t1.<span class="token variable"><span class="token variable">`</span>dept_id<span class="token variable">`</span></span> <span class="token operator">=</span> t2.<span class="token variable"><span class="token variable">`</span><span class="token function">id</span><span class="token variable">`</span></span><span class="token punctuation">;</span><span class="token number">2</span>. 右外连接：* 语法：select 字段列表 from 表1 right <span class="token punctuation">[</span>outer<span class="token punctuation">]</span> <span class="token function">join</span> 表2 on 条件；* 查询的是右表所有数据以及其交集部分。* 例子：SELECT * FROM dept t2 RIGHT JOIN emp t1 ON t1.<span class="token variable"><span class="token variable">`</span>dept_id<span class="token variable">`</span></span> <span class="token operator">=</span> t2.<span class="token variable"><span class="token variable">`</span><span class="token function">id</span><span class="token variable">`</span></span><span class="token punctuation">;</span><span class="token number">3</span>. 子查询：* 概念：查询中嵌套查询，称嵌套查询为子查询。-- 查询工资最高的员工信息-- <span class="token number">1</span> 查询最高的工资是多少 <span class="token number">9000</span>SELECT MAX<span class="token punctuation">(</span>salary<span class="token punctuation">)</span> FROM emp<span class="token punctuation">;</span>-- <span class="token number">2</span> 查询员工信息，并且工资等于9000的SELECT * FROM emp WHERE emp.<span class="token variable"><span class="token variable">`</span>salary<span class="token variable">`</span></span> <span class="token operator">=</span> <span class="token number">9000</span><span class="token punctuation">;</span>-- 一条sql就完成这个操作。子查询SELECT * FROM emp WHERE emp.<span class="token variable"><span class="token variable">`</span>salary<span class="token variable">`</span></span> <span class="token operator">=</span> <span class="token punctuation">(</span>SELECT MAX<span class="token punctuation">(</span>salary<span class="token punctuation">)</span> FROM emp<span class="token punctuation">)</span><span class="token punctuation">;</span>* 子查询不同情况<span class="token number">1</span>. 子查询的结果是单行单列的：* 子查询可以作为条件，使用运算符去判断。 运算符： <span class="token operator">&gt;</span> <span class="token operator">&gt;</span><span class="token operator">=</span> <span class="token operator">&lt;</span> <span class="token operator">&lt;</span><span class="token operator">=</span> <span class="token operator">=</span>* -- 查询员工工资小于平均工资的人SELECT * FROM emp WHERE emp.salary <span class="token operator">&lt;</span> <span class="token punctuation">(</span>SELECT AVG<span class="token punctuation">(</span>salary<span class="token punctuation">)</span> FROM emp<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token number">2</span>. 子查询的结果是多行单列的：* 子查询可以作为条件，使用运算符in来判断-- 查询<span class="token string">'财务部'</span>和<span class="token string">'市场部'</span>所有的员工信息SELECT <span class="token function">id</span> FROM dept WHERE NAME <span class="token operator">=</span> <span class="token string">'财务部'</span> OR NAME <span class="token operator">=</span> <span class="token string">'市场部'</span><span class="token punctuation">;</span>SELECT * FROM emp WHERE dept_id <span class="token operator">=</span> <span class="token number">3</span> OR dept_id <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>-- 子查询SELECT * FROM emp WHERE dept_id IN <span class="token punctuation">(</span>SELECT <span class="token function">id</span> FROM dept WHERE NAME <span class="token operator">=</span> <span class="token string">'财务部'</span> OR NAME <span class="token operator">=</span> <span class="token string">'市场部'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token number">3</span>. 子查询的结果是多行多列的：* 子查询可以作为一张虚拟表参与查询-- 查询员工入职日期是2011-11-11日之后的员工信息和部门信息-- 子查询SELECT * FROM dept t1 ,<span class="token punctuation">(</span>SELECT * FROM emp WHERE emp.<span class="token variable"><span class="token variable">`</span>join_date<span class="token variable">`</span></span> <span class="token operator">&gt;</span> <span class="token string">'2011-11-11'</span><span class="token punctuation">)</span> t2WHERE t1.id <span class="token operator">=</span> t2.dept_id<span class="token punctuation">;</span>-- 普通内连接SELECT * FROM emp t1,dept t2 WHERE t1.<span class="token variable"><span class="token variable">`</span>dept_id<span class="token variable">`</span></span> <span class="token operator">=</span> t2.<span class="token variable"><span class="token variable">`</span><span class="token function">id</span><span class="token variable">`</span></span> AND t1.<span class="token variable"><span class="token variable">`</span>join_date<span class="token variable">`</span></span> <span class="token operator">&gt;</span>  <span class="token string">'2011-11-11'</span>* 多表查询练习-- 部门表CREATE TABLE dept <span class="token punctuation">(</span>  <span class="token function">id</span> INT PRIMARY KEY PRIMARY KEY, -- 部门id  dname VARCHAR<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span>, -- 部门名称  loc VARCHAR<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> -- 部门所在地<span class="token punctuation">)</span><span class="token punctuation">;</span>-- 添加4个部门INSERT INTO dept<span class="token punctuation">(</span>id,dname,loc<span class="token punctuation">)</span> VALUES <span class="token punctuation">(</span><span class="token number">10</span>,<span class="token string">'教研部'</span>,<span class="token string">'北京'</span><span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token number">20</span>,<span class="token string">'学工部'</span>,<span class="token string">'上海'</span><span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token number">30</span>,<span class="token string">'销售部'</span>,<span class="token string">'广州'</span><span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token number">40</span>,<span class="token string">'财务部'</span>,<span class="token string">'深圳'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>​<br>​                </p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">-- 职务表，职务名称，职务描述CREATE TABLE job <span class="token punctuation">(</span>  <span class="token function">id</span> INT PRIMARY KEY,  jname VARCHAR<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>,  description VARCHAR<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>-- 添加4个职务INSERT INTO job <span class="token punctuation">(</span>id, jname, description<span class="token punctuation">)</span> VALUES<span class="token punctuation">(</span><span class="token number">1</span>, <span class="token string">'董事长'</span>, <span class="token string">'管理整个公司，接单'</span><span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token number">2</span>, <span class="token string">'经理'</span>, <span class="token string">'管理部门员工'</span><span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token number">3</span>, <span class="token string">'销售员'</span>, <span class="token string">'向客人推销产品'</span><span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token number">4</span>, <span class="token string">'文员'</span>, <span class="token string">'使用办公软件'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>​<br>​                </p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">-- 员工表CREATE TABLE emp <span class="token punctuation">(</span>  <span class="token function">id</span> INT PRIMARY KEY, -- 员工id  ename VARCHAR<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span>, -- 员工姓名  job_id INT, -- 职务id  mgr INT , -- 上级领导  joindate DATE, -- 入职日期  salary DECIMAL<span class="token punctuation">(</span><span class="token number">7,2</span><span class="token punctuation">)</span>, -- 工资  bonus DECIMAL<span class="token punctuation">(</span><span class="token number">7,2</span><span class="token punctuation">)</span>, -- 奖金  dept_id INT, -- 所在部门编号  CONSTRAINT emp_jobid_ref_job_id_fk FOREIGN KEY <span class="token punctuation">(</span>job_id<span class="token punctuation">)</span> REFERENCES job <span class="token punctuation">(</span>id<span class="token punctuation">)</span>,  CONSTRAINT emp_deptid_ref_dept_id_fk FOREIGN KEY <span class="token punctuation">(</span>dept_id<span class="token punctuation">)</span> REFERENCES dept <span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>-- 添加员工INSERT INTO emp<span class="token punctuation">(</span>id,ename,job_id,mgr,joindate,salary,bonus,dept_id<span class="token punctuation">)</span> VALUES <span class="token punctuation">(</span><span class="token number">1001</span>,<span class="token string">'孙悟空'</span>,4,1004,<span class="token string">'2000-12-17'</span>,<span class="token string">'8000.00'</span>,NULL,20<span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token number">1002</span>,<span class="token string">'卢俊义'</span>,3,1006,<span class="token string">'2001-02-20'</span>,<span class="token string">'16000.00'</span>,<span class="token string">'3000.00'</span>,30<span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token number">1003</span>,<span class="token string">'林冲'</span>,3,1006,<span class="token string">'2001-02-22'</span>,<span class="token string">'12500.00'</span>,<span class="token string">'5000.00'</span>,30<span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token number">1004</span>,<span class="token string">'唐僧'</span>,2,1009,<span class="token string">'2001-04-02'</span>,<span class="token string">'29750.00'</span>,NULL,20<span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token number">1005</span>,<span class="token string">'李逵'</span>,4,1006,<span class="token string">'2001-09-28'</span>,<span class="token string">'12500.00'</span>,<span class="token string">'14000.00'</span>,30<span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token number">1006</span>,<span class="token string">'宋江'</span>,2,1009,<span class="token string">'2001-05-01'</span>,<span class="token string">'28500.00'</span>,NULL,30<span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token number">1007</span>,<span class="token string">'刘备'</span>,2,1009,<span class="token string">'2001-09-01'</span>,<span class="token string">'24500.00'</span>,NULL,10<span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token number">1008</span>,<span class="token string">'猪八戒'</span>,4,1004,<span class="token string">'2007-04-19'</span>,<span class="token string">'30000.00'</span>,NULL,20<span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token number">1009</span>,<span class="token string">'罗贯中'</span>,1,NULL,<span class="token string">'2001-11-17'</span>,<span class="token string">'50000.00'</span>,NULL,10<span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token number">1010</span>,<span class="token string">'吴用'</span>,3,1006,<span class="token string">'2001-09-08'</span>,<span class="token string">'15000.00'</span>,<span class="token string">'0.00'</span>,30<span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token number">1011</span>,<span class="token string">'沙僧'</span>,4,1004,<span class="token string">'2007-05-23'</span>,<span class="token string">'11000.00'</span>,NULL,20<span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token number">1012</span>,<span class="token string">'李逵'</span>,4,1006,<span class="token string">'2001-12-03'</span>,<span class="token string">'9500.00'</span>,NULL,30<span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token number">1013</span>,<span class="token string">'小白龙'</span>,4,1004,<span class="token string">'2001-12-03'</span>,<span class="token string">'30000.00'</span>,NULL,20<span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token number">1014</span>,<span class="token string">'关羽'</span>,4,1007,<span class="token string">'2002-01-23'</span>,<span class="token string">'13000.00'</span>,NULL,10<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>​<br>​                </p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">-- 工资等级表CREATE TABLE salarygrade <span class="token punctuation">(</span>  grade INT PRIMARY KEY,   -- 级别  losalary INT,  -- 最低工资  hisalary INT -- 最高工资<span class="token punctuation">)</span><span class="token punctuation">;</span>-- 添加5个工资等级INSERT INTO salarygrade<span class="token punctuation">(</span>grade,losalary,hisalary<span class="token punctuation">)</span> VALUES <span class="token punctuation">(</span><span class="token number">1,7000</span>,12000<span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token number">2,12010</span>,14000<span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token number">3,14010</span>,20000<span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token number">4,20010</span>,30000<span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token number">5,30010</span>,99990<span class="token punctuation">)</span><span class="token punctuation">;</span>-- 需求：-- <span class="token number">1</span>.查询所有员工信息。查询员工编号，员工姓名，工资，职务名称，职务描述/*分析：<span class="token number">1</span>.员工编号，员工姓名，工资，需要查询emp表  职务名称，职务描述 需要查询job表<span class="token number">2</span>.查询条件 emp.job_id <span class="token operator">=</span> job.id*/SELECT t1.<span class="token variable"><span class="token variable">`</span><span class="token function">id</span><span class="token variable">`</span></span>, -- 员工编号t1.<span class="token variable"><span class="token variable">`</span>ename<span class="token variable">`</span></span>, -- 员工姓名t1.<span class="token variable"><span class="token variable">`</span>salary<span class="token variable">`</span></span>,-- 工资t2.<span class="token variable"><span class="token variable">`</span>jname<span class="token variable">`</span></span>, -- 职务名称t2.<span class="token variable"><span class="token variable">`</span>description<span class="token variable">`</span></span> -- 职务描述FROM emp t1, job t2WHERE t1.<span class="token variable"><span class="token variable">`</span>job_id<span class="token variable">`</span></span> <span class="token operator">=</span> t2.<span class="token variable"><span class="token variable">`</span><span class="token function">id</span><span class="token variable">`</span></span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>​<br>​                </p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">-- <span class="token number">2</span>.查询员工编号，员工姓名，工资，职务名称，职务描述，部门名称，部门位置/*分析：<span class="token number">1</span>. 员工编号，员工姓名，工资 emp  职务名称，职务描述 job  部门名称，部门位置 dept<span class="token number">2</span>. 条件： emp.job_id <span class="token operator">=</span> job.id and emp.dept_id <span class="token operator">=</span> dept.id*/SELECT t1.<span class="token variable"><span class="token variable">`</span><span class="token function">id</span><span class="token variable">`</span></span>, -- 员工编号t1.<span class="token variable"><span class="token variable">`</span>ename<span class="token variable">`</span></span>, -- 员工姓名t1.<span class="token variable"><span class="token variable">`</span>salary<span class="token variable">`</span></span>,-- 工资t2.<span class="token variable"><span class="token variable">`</span>jname<span class="token variable">`</span></span>, -- 职务名称t2.<span class="token variable"><span class="token variable">`</span>description<span class="token variable">`</span></span>, -- 职务描述t3.<span class="token variable"><span class="token variable">`</span>dname<span class="token variable">`</span></span>, -- 部门名称t3.<span class="token variable"><span class="token variable">`</span>loc<span class="token variable">`</span></span> -- 部门位置FROM emp t1, job t2,dept t3WHERE t1.<span class="token variable"><span class="token variable">`</span>job_id<span class="token variable">`</span></span> <span class="token operator">=</span> t2.<span class="token variable"><span class="token variable">`</span><span class="token function">id</span><span class="token variable">`</span></span> AND t1.<span class="token variable"><span class="token variable">`</span>dept_id<span class="token variable">`</span></span> <span class="token operator">=</span> t3.<span class="token variable"><span class="token variable">`</span><span class="token function">id</span><span class="token variable">`</span></span><span class="token punctuation">;</span>   -- <span class="token number">3</span>.查询员工姓名，工资，工资等级/*分析：<span class="token number">1</span>.员工姓名，工资 emp  工资等级 salarygrade<span class="token number">2</span>.条件 emp.salary <span class="token operator">&gt;</span><span class="token operator">=</span> salarygrade.losalary and emp.salary <span class="token operator">&lt;</span><span class="token operator">=</span> salarygrade.hisalaryemp.salary BETWEEN salarygrade.losalary and salarygrade.hisalary*/SELECT t1.ename ,t1.<span class="token variable"><span class="token variable">`</span>salary<span class="token variable">`</span></span>,t2.*FROM emp t1, salarygrade t2WHERE t1.<span class="token variable"><span class="token variable">`</span>salary<span class="token variable">`</span></span> BETWEEN t2.<span class="token variable"><span class="token variable">`</span>losalary<span class="token variable">`</span></span> AND t2.<span class="token variable"><span class="token variable">`</span>hisalary<span class="token variable">`</span></span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>​<br>​                </p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">-- <span class="token number">4</span>.查询员工姓名，工资，职务名称，职务描述，部门名称，部门位置，工资等级/*分析：<span class="token number">1</span>. 员工姓名，工资 emp ， 职务名称，职务描述 job 部门名称，部门位置，dept  工资等级 salarygrade<span class="token number">2</span>. 条件： emp.job_id <span class="token operator">=</span> job.id and emp.dept_id <span class="token operator">=</span> dept.id and emp.salary BETWEEN salarygrade.losalary and salarygrade.hisalary*/SELECT t1.<span class="token variable"><span class="token variable">`</span>ename<span class="token variable">`</span></span>,t1.<span class="token variable"><span class="token variable">`</span>salary<span class="token variable">`</span></span>,t2.<span class="token variable"><span class="token variable">`</span>jname<span class="token variable">`</span></span>,t2.<span class="token variable"><span class="token variable">`</span>description<span class="token variable">`</span></span>,t3.<span class="token variable"><span class="token variable">`</span>dname<span class="token variable">`</span></span>,t3.<span class="token variable"><span class="token variable">`</span>loc<span class="token variable">`</span></span>,t4.<span class="token variable"><span class="token variable">`</span>grade<span class="token variable">`</span></span>FROM emp t1,job t2,dept t3,salarygrade t4WHERE t1.<span class="token variable"><span class="token variable">`</span>job_id<span class="token variable">`</span></span> <span class="token operator">=</span> t2.<span class="token variable"><span class="token variable">`</span><span class="token function">id</span><span class="token variable">`</span></span> AND t1.<span class="token variable"><span class="token variable">`</span>dept_id<span class="token variable">`</span></span> <span class="token operator">=</span> t3.<span class="token variable"><span class="token variable">`</span><span class="token function">id</span><span class="token variable">`</span></span>AND t1.<span class="token variable"><span class="token variable">`</span>salary<span class="token variable">`</span></span> BETWEEN t4.<span class="token variable"><span class="token variable">`</span>losalary<span class="token variable">`</span></span> AND t4.<span class="token variable"><span class="token variable">`</span>hisalary<span class="token variable">`</span></span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>​<br>​                </p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">-- <span class="token number">5</span>.查询出部门编号、部门名称、部门位置、部门人数/*分析：<span class="token number">1</span>.部门编号、部门名称、部门位置 dept 表。 部门人数 emp表<span class="token number">2</span>.使用分组查询。按照emp.dept_id完成分组，查询count<span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token number">3</span>.使用子查询将第2步的查询结果和dept表进行关联查询*/SELECT t1.<span class="token variable"><span class="token variable">`</span><span class="token function">id</span><span class="token variable">`</span></span>,t1.<span class="token variable"><span class="token variable">`</span>dname<span class="token variable">`</span></span>,t1.<span class="token variable"><span class="token variable">`</span>loc<span class="token variable">`</span></span> , t2.totalFROM dept t1,<span class="token punctuation">(</span>SELECTdept_id,COUNT<span class="token punctuation">(</span>id<span class="token punctuation">)</span> totalFROM empGROUP BY dept_id<span class="token punctuation">)</span> t2WHERE t1.<span class="token variable"><span class="token variable">`</span><span class="token function">id</span><span class="token variable">`</span></span> <span class="token operator">=</span> t2.dept_id<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>​                </p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">-- <span class="token number">6</span>.查询所有员工的姓名及其直接上级的姓名,没有领导的员工也需要查询/*分析：<span class="token number">1</span>.姓名 emp， 直接上级的姓名 emp* emp表的id 和 mgr 是自关联<span class="token number">2</span>.条件 emp.id <span class="token operator">=</span> emp.mgr<span class="token number">3</span>.查询左表的所有数据，和 交集数据* 使用左外连接查询*//*<span class="token keyword">select</span>t1.ename,t1.mgr,t2.<span class="token variable"><span class="token variable">`</span><span class="token function">id</span><span class="token variable">`</span></span>,t2.enamefrom emp t1, emp t2where t1.mgr <span class="token operator">=</span> t2.<span class="token variable"><span class="token variable">`</span><span class="token function">id</span><span class="token variable">`</span></span><span class="token punctuation">;</span>*/SELECT t1.ename,t1.mgr,t2.<span class="token variable"><span class="token variable">`</span><span class="token function">id</span><span class="token variable">`</span></span>,t2.<span class="token variable"><span class="token variable">`</span>ename<span class="token variable">`</span></span>FROM emp t1LEFT JOIN emp t2ON t1.<span class="token variable"><span class="token variable">`</span>mgr<span class="token variable">`</span></span> <span class="token operator">=</span> t2.<span class="token variable"><span class="token variable">`</span><span class="token function">id</span><span class="token variable">`</span></span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="事务"><a href="#事务" class="headerlink" title="事务"></a>事务</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">1</span>. 事务的基本介绍<span class="token number">1</span>. 概念：*  如果一个包含多个步骤的业务操作，被事务管理，那么这些操作要么同时成功，要么同时失败。<span class="token number">2</span>. 操作：<span class="token number">1</span>. 开启事务： start transaction<span class="token punctuation">;</span><span class="token number">2</span>. 回滚：rollback<span class="token punctuation">;</span><span class="token number">3</span>. 提交：commit<span class="token punctuation">;</span><span class="token number">3</span>. 例子：CREATE TABLE account <span class="token punctuation">(</span><span class="token function">id</span> INT PRIMARY KEY AUTO_INCREMENT,NAME VARCHAR<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>,balance DOUBLE<span class="token punctuation">)</span><span class="token punctuation">;</span>-- 添加数据INSERT INTO account <span class="token punctuation">(</span>NAME, balance<span class="token punctuation">)</span> VALUES <span class="token punctuation">(</span><span class="token string">'zhangsan'</span>, <span class="token number">1000</span><span class="token punctuation">)</span>, <span class="token punctuation">(</span><span class="token string">'lisi'</span>, <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>​            </p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">SELECT * FROM account<span class="token punctuation">;</span>UPDATE account SET balance <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">;</span>-- 张三给李四转账 <span class="token number">500</span> 元-- <span class="token number">0</span>. 开启事务START TRANSACTION<span class="token punctuation">;</span>-- <span class="token number">1</span>. 张三账户 -500UPDATE account SET balance <span class="token operator">=</span> balance - <span class="token number">500</span> WHERE NAME <span class="token operator">=</span> <span class="token string">'zhangsan'</span><span class="token punctuation">;</span>-- <span class="token number">2</span>. 李四账户 +500-- 出错了<span class="token punctuation">..</span>.UPDATE account SET balance <span class="token operator">=</span> balance + <span class="token number">500</span> WHERE NAME <span class="token operator">=</span> <span class="token string">'lisi'</span><span class="token punctuation">;</span>-- 发现执行没有问题，提交事务COMMIT<span class="token punctuation">;</span>-- 发现出问题了，回滚事务ROLLBACK<span class="token punctuation">;</span><span class="token number">4</span>. MySQL数据库中事务默认自动提交* 事务提交的两种方式：* 自动提交：* mysql就是自动提交的* 一条DML<span class="token punctuation">(</span>增删改<span class="token punctuation">)</span>语句会自动提交一次事务。* 手动提交：* Oracle 数据库默认是手动提交事务* 需要先开启事务，再提交* 修改事务的默认提交方式：* 查看事务的默认提交方式：SELECT @@autocommit<span class="token punctuation">;</span> -- <span class="token number">1</span> 代表自动提交  <span class="token number">0</span> 代表手动提交* 修改默认提交方式： <span class="token builtin class-name">set</span> @@autocommit <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">2</span>. 事务的四大特征：<span class="token number">1</span>. 原子性：是不可分割的最小操作单位，要么同时成功，要么同时失败。<span class="token number">2</span>. 持久性：当事务提交或回滚后，数据库会持久化的保存数据。<span class="token number">3</span>. 隔离性：多个事务之间。相互独立。<span class="token number">4</span>. 一致性：事务操作前后，数据总量不变<span class="token number">3</span>. 事务的隔离级别（了解）* 概念：多个事务之间隔离的，相互独立的。但是如果多个事务操作同一批数据，则会引发一些问题，设置不同的隔离级别就可以解决这些问题。* 存在问题：<span class="token number">1</span>. 脏读：一个事务，读取到另一个事务中没有提交的数据<span class="token number">2</span>. 不可重复读<span class="token punctuation">(</span>虚读<span class="token punctuation">)</span>：在同一个事务中，两次读取到的数据不一样。<span class="token number">3</span>. 幻读：一个事务操作<span class="token punctuation">(</span>DML<span class="token punctuation">)</span>数据表中所有记录，另一个事务添加了一条数据，则第一个事务查询不到自己的修改。* 隔离级别：<span class="token number">1</span>. <span class="token builtin class-name">read</span> uncommitted：读未提交* 产生的问题：脏读、不可重复读、幻读<span class="token number">2</span>. <span class="token builtin class-name">read</span> committed：读已提交 （Oracle）* 产生的问题：不可重复读、幻读<span class="token number">3</span>. repeatable read：可重复读 （MySQL默认）* 产生的问题：幻读<span class="token number">4</span>. serializable：串行化* 可以解决所有的问题* 注意：隔离级别从小到大安全性越来越高，但是效率越来越低* 数据库查询隔离级别：* <span class="token keyword">select</span> @@tx_isolation<span class="token punctuation">;</span>* 数据库设置隔离级别：* <span class="token builtin class-name">set</span> global transaction isolation level  级别字符串<span class="token punctuation">;</span>* 演示：<span class="token builtin class-name">set</span> global transaction isolation level <span class="token builtin class-name">read</span> uncommitted<span class="token punctuation">;</span>start transaction<span class="token punctuation">;</span>-- 转账操作update account <span class="token builtin class-name">set</span> balance <span class="token operator">=</span> balance - <span class="token number">500</span> where <span class="token function">id</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>update account <span class="token builtin class-name">set</span> balance <span class="token operator">=</span> balance + <span class="token number">500</span> where <span class="token function">id</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="DCL"><a href="#DCL" class="headerlink" title="DCL"></a>DCL</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">* SQL分类：<span class="token number">1</span>. DDL：操作数据库和表<span class="token number">2</span>. DML：增删改表中数据<span class="token number">3</span>. DQL：查询表中数据<span class="token number">4</span>. DCL：管理用户，授权* DBA：数据库管理员* DCL：管理用户，授权<span class="token number">1</span>. 管理用户<span class="token number">1</span>. 添加用户：* 语法：CREATE <span class="token environment constant">USER</span> <span class="token string">'用户名'</span>@<span class="token string">'主机名'</span> IDENTIFIED BY <span class="token string">'密码'</span><span class="token punctuation">;</span><span class="token number">2</span>. 删除用户：* 语法：DROP <span class="token environment constant">USER</span> <span class="token string">'用户名'</span>@<span class="token string">'主机名'</span><span class="token punctuation">;</span><span class="token number">3</span>. 修改用户密码：UPDATE <span class="token environment constant">USER</span> SET PASSWORD <span class="token operator">=</span> PASSWORD<span class="token punctuation">(</span><span class="token string">'新密码'</span><span class="token punctuation">)</span> WHERE <span class="token environment constant">USER</span> <span class="token operator">=</span> <span class="token string">'用户名'</span><span class="token punctuation">;</span>UPDATE <span class="token environment constant">USER</span> SET PASSWORD <span class="token operator">=</span> PASSWORD<span class="token punctuation">(</span><span class="token string">'abc'</span><span class="token punctuation">)</span> WHERE <span class="token environment constant">USER</span> <span class="token operator">=</span> <span class="token string">'lisi'</span><span class="token punctuation">;</span>SET PASSWORD FOR <span class="token string">'用户名'</span>@<span class="token string">'主机名'</span> <span class="token operator">=</span> PASSWORD<span class="token punctuation">(</span><span class="token string">'新密码'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>SET PASSWORD FOR <span class="token string">'root'</span>@<span class="token string">'localhost'</span> <span class="token operator">=</span> PASSWORD<span class="token punctuation">(</span><span class="token string">'123'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>* mysql中忘记了root用户的密码？<span class="token number">1</span>. cmd -- <span class="token operator">&gt;</span> net stop mysql 停止mysql服务* 需要管理员运行该cmd<span class="token number">2</span>. 使用无验证方式启动mysql服务： mysqld --skip-grant-tables<span class="token number">3</span>. 打开新的cmd窗口,直接输入mysql命令，敲回车。就可以登录成功<span class="token number">4</span>. use mysql<span class="token punctuation">;</span><span class="token number">5</span>. update user <span class="token builtin class-name">set</span> password <span class="token operator">=</span> password<span class="token punctuation">(</span><span class="token string">'你的新密码'</span><span class="token punctuation">)</span> where user <span class="token operator">=</span> <span class="token string">'root'</span><span class="token punctuation">;</span><span class="token number">6</span>. 关闭两个窗口<span class="token number">7</span>. 打开任务管理器，手动结束mysqld.exe 的进程<span class="token number">8</span>. 启动mysql服务<span class="token number">9</span>. 使用新密码登录。<span class="token number">4</span>. 查询用户：-- <span class="token number">1</span>. 切换到mysql数据库USE myql<span class="token punctuation">;</span>-- <span class="token number">2</span>. 查询user表SELECT * FROM <span class="token environment constant">USER</span><span class="token punctuation">;</span>* 通配符： % 表示可以在任意主机使用用户登录数据库<span class="token number">2</span>. 权限管理：<span class="token number">1</span>. 查询权限：-- 查询权限SHOW GRANTS FOR <span class="token string">'用户名'</span>@<span class="token string">'主机名'</span><span class="token punctuation">;</span>SHOW GRANTS FOR <span class="token string">'lisi'</span>@<span class="token string">'%'</span><span class="token punctuation">;</span><span class="token number">2</span>. 授予权限：-- 授予权限grant 权限列表 on 数据库名.表名 to <span class="token string">'用户名'</span>@<span class="token string">'主机名'</span><span class="token punctuation">;</span>-- 给张三用户授予所有权限，在任意数据库任意表上GRANT ALL ON *.* TO <span class="token string">'zhangsan'</span>@<span class="token string">'localhost'</span><span class="token punctuation">;</span><span class="token number">3</span>. 撤销权限：-- 撤销权限：revoke 权限列表 on 数据库名.表名 from <span class="token string">'用户名'</span>@<span class="token string">'主机名'</span><span class="token punctuation">;</span>REVOKE UPDATE ON db3.<span class="token variable"><span class="token variable">`</span>account<span class="token variable">`</span></span> FROM <span class="token string">'lisi'</span>@<span class="token string">'%'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="JDBC："><a href="#JDBC：" class="headerlink" title="JDBC："></a>JDBC：</h4><p>​    1. 概念：Java DataBase Connectivity  Java 数据库连接， Java语言操作数据库<br>​        * JDBC本质：其实是官方（sun公司）定义的一套操作所有关系型数据库的规则，即接口。各个数据库厂商去实现这套接口，提供数据库驱动jar包。我们可以使用这套接口（JDBC）编程，真正执行的代码是驱动jar包中的实现类。</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">2</span>. 快速入门：* 步骤：<span class="token number">1</span>. 导入驱动jar包 mysql-connector-java-5.1.37-bin.jar<span class="token number">1</span>.复制mysql-connector-java-5.1.37-bin.jar到项目的libs目录下<span class="token number">2</span>.右键--<span class="token operator">&gt;</span>Add As Library<span class="token number">2</span>. 注册驱动<span class="token number">3</span>. 获取数据库连接对象 Connection<span class="token number">4</span>. 定义sql<span class="token number">5</span>. 获取执行sql语句的对象 Statement<span class="token number">6</span>. 执行sql，接受返回结果<span class="token number">7</span>. 处理结果<span class="token number">8</span>. 释放资源* 代码实现：  //1. 导入驱动jar包        //2.注册驱动        Class.forName<span class="token punctuation">(</span><span class="token string">"com.mysql.jdbc.Driver"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        //3.获取数据库连接对象        Connection conn <span class="token operator">=</span> DriverManager.getConnection<span class="token punctuation">(</span><span class="token string">"jdbc:mysql://localhost:3306/db3"</span>, <span class="token string">"root"</span>, <span class="token string">"root"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        //4.定义sql语句        String sql <span class="token operator">=</span> <span class="token string">"update account set balance = 500 where id = 1"</span><span class="token punctuation">;</span>        //5.获取执行sql的对象 Statement        Statement stmt <span class="token operator">=</span> conn.createStatement<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        //6.执行sql        int count <span class="token operator">=</span> stmt.executeUpdate<span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>        //7.处理结果        System.out.println<span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>        //8.释放资源        stmt.close<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        conn.close<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token number">3</span>. 详解各个对象：<span class="token number">1</span>. DriverManager：驱动管理对象* 功能：<span class="token number">1</span>. 注册驱动：告诉程序该使用哪一个数据库驱动jarstatic void registerDriver<span class="token punctuation">(</span>Driver driver<span class="token punctuation">)</span> :注册与给定的驱动程序 DriverManager 。 写代码使用：  Class.forName<span class="token punctuation">(</span><span class="token string">"com.mysql.jdbc.Driver"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>通过查看源码发现：在com.mysql.jdbc.Driver类中存在静态代码块 static <span class="token punctuation">{</span>        try <span class="token punctuation">{</span>            java.sql.DriverManager.registerDriver<span class="token punctuation">(</span>new Driver<span class="token punctuation">(</span><span class="token punctuation">))</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> catch <span class="token punctuation">(</span>SQLException E<span class="token punctuation">)</span> <span class="token punctuation">{</span>            throw new RuntimeException<span class="token punctuation">(</span><span class="token string">"Can't register driver!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token punctuation">}</span>注意：mysql5之后的驱动jar包可以省略注册驱动的步骤。<span class="token number">2</span>. 获取数据库连接：* 方法：static Connection getConnection<span class="token punctuation">(</span>String url, String user, String password<span class="token punctuation">)</span> * 参数：* url：指定连接的路径* 语法：jdbc:mysql://ip地址<span class="token punctuation">(</span>域名<span class="token punctuation">)</span>:端口号/数据库名称* 例子：jdbc:mysql://localhost:3306/db3* 细节：如果连接的是本机mysql服务器，并且mysql服务默认端口是3306，则url可以简写为：jdbc:mysql:///数据库名称* user：用户名* password：密码 <span class="token number">2</span>. Connection：数据库连接对象<span class="token number">1</span>. 功能：<span class="token number">1</span>. 获取执行sql 的对象* Statement createStatement<span class="token punctuation">(</span><span class="token punctuation">)</span>* PreparedStatement prepareStatement<span class="token punctuation">(</span>String sql<span class="token punctuation">)</span>  <span class="token number">2</span>. 管理事务：* 开启事务：setAutoCommit<span class="token punctuation">(</span>boolean autoCommit<span class="token punctuation">)</span> ：调用该方法设置参数为false，即开启事务* 提交事务：commit<span class="token punctuation">(</span><span class="token punctuation">)</span> * 回滚事务：rollback<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token number">3</span>. Statement：执行sql的对象<span class="token number">1</span>. 执行sql<span class="token number">1</span>. boolean execute<span class="token punctuation">(</span>String sql<span class="token punctuation">)</span> ：可以执行任意的sql 了解 <span class="token number">2</span>. int executeUpdate<span class="token punctuation">(</span>String sql<span class="token punctuation">)</span> ：执行DML（insert、update、delete）语句、DDL<span class="token punctuation">(</span>create，alter、drop<span class="token punctuation">)</span>语句* 返回值：影响的行数，可以通过这个影响的行数判断DML语句是否执行成功 返回值<span class="token operator">&gt;</span><span class="token number">0</span>的则执行成功，反之，则失败。<span class="token number">3</span>. ResultSet executeQuery<span class="token punctuation">(</span>String sql<span class="token punctuation">)</span>  ：执行DQL（select<span class="token punctuation">)</span>语句<span class="token number">2</span>. 练习：<span class="token number">1</span>. account表 添加一条记录<span class="token number">2</span>. account表 修改记录<span class="token number">3</span>. account表 删除一条记录代码：Statement stmt <span class="token operator">=</span> null<span class="token punctuation">;</span>        Connection conn <span class="token operator">=</span> null<span class="token punctuation">;</span>        try <span class="token punctuation">{</span>            //1. 注册驱动            Class.forName<span class="token punctuation">(</span><span class="token string">"com.mysql.jdbc.Driver"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            //2. 定义sql            String sql <span class="token operator">=</span> <span class="token string">"insert into account values(null,'王五',3000)"</span><span class="token punctuation">;</span>            //3.获取Connection对象            conn <span class="token operator">=</span> DriverManager.getConnection<span class="token punctuation">(</span><span class="token string">"jdbc:mysql:///db3"</span>, <span class="token string">"root"</span>, <span class="token string">"root"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            //4.获取执行sql的对象 Statement            stmt <span class="token operator">=</span> conn.createStatement<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            //5.执行sql            int count <span class="token operator">=</span> stmt.executeUpdate<span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>//影响的行数            //6.处理结果            System.out.println<span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>            if<span class="token punctuation">(</span>count <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                System.out.println<span class="token punctuation">(</span><span class="token string">"添加成功！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>else<span class="token punctuation">{</span>                System.out.println<span class="token punctuation">(</span><span class="token string">"添加失败！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span> catch <span class="token punctuation">(</span>ClassNotFoundException e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            e.printStackTrace<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> catch <span class="token punctuation">(</span>SQLException e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            e.printStackTrace<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>finally <span class="token punctuation">{</span>            //stmt.close<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            //7. 释放资源            //避免空指针异常            if<span class="token punctuation">(</span>stmt <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>                try <span class="token punctuation">{</span>                    stmt.close<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span> catch <span class="token punctuation">(</span>SQLException e<span class="token punctuation">)</span> <span class="token punctuation">{</span>                    e.printStackTrace<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span>            if<span class="token punctuation">(</span>conn <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>                try <span class="token punctuation">{</span>                    conn.close<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span> catch <span class="token punctuation">(</span>SQLException e<span class="token punctuation">)</span> <span class="token punctuation">{</span>                    e.printStackTrace<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span><span class="token number">4</span>. ResultSet：结果集对象,封装查询结果* boolean next<span class="token punctuation">(</span><span class="token punctuation">)</span>: 游标向下移动一行，判断当前行是否是最后一行末尾<span class="token punctuation">(</span>是否有数据<span class="token punctuation">)</span>，如果是，则返回false，如果不是则返回true* getXxx<span class="token punctuation">(</span>参数<span class="token punctuation">)</span>:获取数据* Xxx：代表数据类型   如： int getInt<span class="token punctuation">(</span><span class="token punctuation">)</span> ,String getString<span class="token punctuation">(</span><span class="token punctuation">)</span>* 参数：<span class="token number">1</span>. int：代表列的编号,从1开始   如： getString<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token number">2</span>. String：代表列名称。 如： getDouble<span class="token punctuation">(</span><span class="token string">"balance"</span><span class="token punctuation">)</span>* 注意：* 使用步骤：<span class="token number">1</span>. 游标向下移动一行<span class="token number">2</span>. 判断是否有数据<span class="token number">3</span>. 获取数据   //循环判断游标是否是最后一行末尾。            while<span class="token punctuation">(</span>rs.next<span class="token punctuation">(</span><span class="token punctuation">))</span><span class="token punctuation">{</span>                //获取数据                //6.2 获取数据                int <span class="token function">id</span> <span class="token operator">=</span> rs.getInt<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                String name <span class="token operator">=</span> rs.getString<span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                double balance <span class="token operator">=</span> rs.getDouble<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                System.out.println<span class="token punctuation">(</span>id + <span class="token string">"---"</span> + name + <span class="token string">"---"</span> + balance<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>* 练习：* 定义一个方法，查询emp表的数据将其封装为对象，然后装载集合，返回。<span class="token number">1</span>. 定义Emp类<span class="token number">2</span>. 定义方法 public List<span class="token operator">&lt;</span>Emp<span class="token operator">&gt;</span> <span class="token function-name function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token number">3</span>. 实现方法 <span class="token keyword">select</span> * from emp<span class="token punctuation">;</span><span class="token number">5</span>. PreparedStatement：执行sql的对象<span class="token number">1</span>. SQL注入问题：在拼接sql时，有一些sql的特殊关键字参与字符串的拼接。会造成安全性问题<span class="token number">1</span>. 输入用户随便，输入密码：a<span class="token string">' or '</span>a<span class="token string">' = '</span>a<span class="token number">2</span>. sql：select * from user where username <span class="token operator">=</span> <span class="token string">'fhdsjkf'</span> and password <span class="token operator">=</span> <span class="token string">'a'</span> or <span class="token string">'a'</span> <span class="token operator">=</span> <span class="token string">'a'</span> <span class="token number">2</span>. 解决sql注入问题：使用PreparedStatement对象来解决<span class="token number">3</span>. 预编译的SQL：参数使用?作为占位符<span class="token number">4</span>. 步骤：<span class="token number">1</span>. 导入驱动jar包 mysql-connector-java-5.1.37-bin.jar<span class="token number">2</span>. 注册驱动<span class="token number">3</span>. 获取数据库连接对象 Connection<span class="token number">4</span>. 定义sql* 注意：sql的参数使用？作为占位符。 如：select * from user where username <span class="token operator">=</span> ? and password <span class="token operator">=</span> ?<span class="token punctuation">;</span><span class="token number">5</span>. 获取执行sql语句的对象 PreparedStatement  Connection.prepareStatement<span class="token punctuation">(</span>String sql<span class="token punctuation">)</span> <span class="token number">6</span>. 给？赋值：* 方法： setXxx<span class="token punctuation">(</span>参数1,参数2<span class="token punctuation">)</span>* 参数1：？的位置编号 从1 开始* 参数2：？的值<span class="token number">7</span>. 执行sql，接受返回结果，不需要传递sql语句<span class="token number">8</span>. 处理结果<span class="token number">9</span>. 释放资源<span class="token number">5</span>. 注意：后期都会使用PreparedStatement来完成增删改查的所有操作<span class="token number">1</span>. 可以防止SQL注入<span class="token number">2</span>. 效率更高<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="抽取JDBC工具类-：-JDBCUtils"><a href="#抽取JDBC工具类-：-JDBCUtils" class="headerlink" title="抽取JDBC工具类 ： JDBCUtils"></a>抽取JDBC工具类 ： JDBCUtils</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">* 目的：简化书写* 分析：<span class="token number">1</span>. 注册驱动也抽取<span class="token number">2</span>. 抽取一个方法获取连接对象* 需求：不想传递参数（麻烦），还得保证工具类的通用性。* 解决：配置文件jdbc.properties<span class="token assign-left variable">url</span><span class="token operator">=</span><span class="token assign-left variable">user</span><span class="token operator">=</span><span class="token assign-left variable">password</span><span class="token operator">=</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">3</span>. 抽取一个方法释放资源* 代码实现：public class JDBCUtils <span class="token punctuation">{</span>    private static String url<span class="token punctuation">;</span>    private static String user<span class="token punctuation">;</span>    private static String password<span class="token punctuation">;</span>    private static String driver<span class="token punctuation">;</span>    /**     * 文件的读取，只需要读取一次即可拿到这些值。使用静态代码块     */    static<span class="token punctuation">{</span>        //读取资源文件，获取值。        try <span class="token punctuation">{</span>            //1. 创建Properties集合类。            Properties pro <span class="token operator">=</span> new Properties<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            //获取src路径下的文件的方式---<span class="token operator">&gt;</span>ClassLoader 类加载器            ClassLoader classLoader <span class="token operator">=</span> JDBCUtils.class.getClassLoader<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            URL res  <span class="token operator">=</span> classLoader.getResource<span class="token punctuation">(</span><span class="token string">"jdbc.properties"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            String path <span class="token operator">=</span> res.getPath<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            System.out.println<span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>///D:/IdeaProjects/itcast/out/production/day04_jdbc/jdbc.properties            //2. 加载文件           // pro.load<span class="token punctuation">(</span>new FileReader<span class="token punctuation">(</span><span class="token string">"D:<span class="token entity" title="\\">\\</span>IdeaProjects<span class="token entity" title="\\">\\</span>itcast<span class="token entity" title="\\">\\</span>day04_jdbc<span class="token entity" title="\\">\\</span>src<span class="token entity" title="\\">\\</span>jdbc.properties"</span><span class="token punctuation">))</span><span class="token punctuation">;</span>            pro.load<span class="token punctuation">(</span>new FileReader<span class="token punctuation">(</span>path<span class="token punctuation">))</span><span class="token punctuation">;</span>            //3. 获取数据，赋值            url <span class="token operator">=</span> pro.getProperty<span class="token punctuation">(</span><span class="token string">"url"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            user <span class="token operator">=</span> pro.getProperty<span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            password <span class="token operator">=</span> pro.getProperty<span class="token punctuation">(</span><span class="token string">"password"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            driver <span class="token operator">=</span> pro.getProperty<span class="token punctuation">(</span><span class="token string">"driver"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            //4. 注册驱动            Class.forName<span class="token punctuation">(</span>driver<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> catch <span class="token punctuation">(</span>IOException e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            e.printStackTrace<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> catch <span class="token punctuation">(</span>ClassNotFoundException e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            e.printStackTrace<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>​    </p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">/** * 获取连接 * @return 连接对象 */public static Connection getConnection<span class="token punctuation">(</span><span class="token punctuation">)</span> throws SQLException <span class="token punctuation">{</span>    <span class="token builtin class-name">return</span> DriverManager.getConnection<span class="token punctuation">(</span>url, user, password<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>/** * 释放资源 * @param stmt * @param conn */public static void close<span class="token punctuation">(</span>Statement stmt,Connection conn<span class="token punctuation">)</span><span class="token punctuation">{</span>    if<span class="token punctuation">(</span> stmt <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>        try <span class="token punctuation">{</span>            stmt.close<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> catch <span class="token punctuation">(</span>SQLException e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            e.printStackTrace<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    if<span class="token punctuation">(</span> conn <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>        try <span class="token punctuation">{</span>            conn.close<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> catch <span class="token punctuation">(</span>SQLException e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            e.printStackTrace<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>​    </p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">    /**     * 释放资源     * @param stmt     * @param conn     */    public static void close<span class="token punctuation">(</span>ResultSet rs,Statement stmt, Connection conn<span class="token punctuation">)</span><span class="token punctuation">{</span>        if<span class="token punctuation">(</span> rs <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>            try <span class="token punctuation">{</span>                rs.close<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> catch <span class="token punctuation">(</span>SQLException e<span class="token punctuation">)</span> <span class="token punctuation">{</span>                e.printStackTrace<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        if<span class="token punctuation">(</span> stmt <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>            try <span class="token punctuation">{</span>                stmt.close<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> catch <span class="token punctuation">(</span>SQLException e<span class="token punctuation">)</span> <span class="token punctuation">{</span>                e.printStackTrace<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        if<span class="token punctuation">(</span> conn <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>            try <span class="token punctuation">{</span>                conn.close<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> catch <span class="token punctuation">(</span>SQLException e<span class="token punctuation">)</span> <span class="token punctuation">{</span>                e.printStackTrace<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span>* 练习：* 需求：<span class="token number">1</span>. 通过键盘录入用户名和密码<span class="token number">2</span>. 判断用户是否登录成功* <span class="token keyword">select</span> * from user where username <span class="token operator">=</span> <span class="token string">""</span> and password <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>* 如果这个sql有查询结果，则成功，反之，则失败* 步骤：<span class="token number">1</span>. 创建数据库表 userCREATE TABLE <span class="token environment constant">USER</span><span class="token punctuation">(</span><span class="token function">id</span> INT PRIMARY KEY AUTO_INCREMENT,username VARCHAR<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span>,PASSWORD VARCHAR<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>INSERT INTO <span class="token environment constant">USER</span> VALUES<span class="token punctuation">(</span>NULL,<span class="token string">'zhangsan'</span>,<span class="token string">'123'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>INSERT INTO <span class="token environment constant">USER</span> VALUES<span class="token punctuation">(</span>NULL,<span class="token string">'lisi'</span>,<span class="token string">'234'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token number">2</span>. 代码实现：public class JDBCDemo9 <span class="token punctuation">{</span>    public static void main<span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        //1.键盘录入，接受用户名和密码        Scanner sc <span class="token operator">=</span> new Scanner<span class="token punctuation">(</span>System.in<span class="token punctuation">)</span><span class="token punctuation">;</span>        System.out.println<span class="token punctuation">(</span><span class="token string">"请输入用户名："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        String username <span class="token operator">=</span> sc.nextLine<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System.out.println<span class="token punctuation">(</span><span class="token string">"请输入密码："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        String password <span class="token operator">=</span> sc.nextLine<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        //2.调用方法        boolean flag <span class="token operator">=</span> new JDBCDemo9<span class="token punctuation">(</span><span class="token punctuation">)</span>.login<span class="token punctuation">(</span>username, password<span class="token punctuation">)</span><span class="token punctuation">;</span>        //3.判断结果，输出不同语句        if<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">{</span>            //登录成功            System.out.println<span class="token punctuation">(</span><span class="token string">"登录成功！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>else<span class="token punctuation">{</span>            System.out.println<span class="token punctuation">(</span><span class="token string">"用户名或密码错误！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>​<br>​                </p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">/** * 登录方法 */public boolean login<span class="token punctuation">(</span>String username ,String password<span class="token punctuation">)</span><span class="token punctuation">{</span>    if<span class="token punctuation">(</span>username <span class="token operator">==</span> null <span class="token operator">||</span> password <span class="token operator">==</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token builtin class-name">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    //连接数据库判断是否登录成功    Connection conn <span class="token operator">=</span> null<span class="token punctuation">;</span>    Statement stmt <span class="token operator">=</span>  null<span class="token punctuation">;</span>    ResultSet rs <span class="token operator">=</span> null<span class="token punctuation">;</span>    //1.获取连接    try <span class="token punctuation">{</span>        conn <span class="token operator">=</span>  JDBCUtils.getConnection<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        //2.定义sql        String sql <span class="token operator">=</span> <span class="token string">"select * from user where username = '"</span>+username+<span class="token string">"' and password = '"</span>+password+<span class="token string">"' "</span><span class="token punctuation">;</span>        //3.获取执行sql的对象        stmt <span class="token operator">=</span> conn.createStatement<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        //4.执行查询        rs <span class="token operator">=</span> stmt.executeQuery<span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>        //5.判断       /* if<span class="token punctuation">(</span>rs.next<span class="token punctuation">(</span><span class="token punctuation">))</span><span class="token punctuation">{</span>//如果有下一行，则返回true            <span class="token builtin class-name">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>else<span class="token punctuation">{</span>            <span class="token builtin class-name">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>*/       <span class="token builtin class-name">return</span> rs.next<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>//如果有下一行，则返回true    <span class="token punctuation">}</span> catch <span class="token punctuation">(</span>SQLException e<span class="token punctuation">)</span> <span class="token punctuation">{</span>        e.printStackTrace<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>finally <span class="token punctuation">{</span>        JDBCUtils.close<span class="token punctuation">(</span>rs,stmt,conn<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>     <span class="token builtin class-name">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>     <span class="token punctuation">}</span>     <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="JDBC控制事务："><a href="#JDBC控制事务：" class="headerlink" title="JDBC控制事务："></a>JDBC控制事务：</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">1</span>. 事务：一个包含多个步骤的业务操作。如果这个业务操作被事务管理，则这多个步骤要么同时成功，要么同时失败。<span class="token number">2</span>. 操作：<span class="token number">1</span>. 开启事务<span class="token number">2</span>. 提交事务<span class="token number">3</span>. 回滚事务<span class="token number">3</span>. 使用Connection对象来管理事务* 开启事务：setAutoCommit<span class="token punctuation">(</span>boolean autoCommit<span class="token punctuation">)</span> ：调用该方法设置参数为false，即开启事务* 在执行sql之前开启事务* 提交事务：commit<span class="token punctuation">(</span><span class="token punctuation">)</span> * 当所有sql都执行完提交事务* 回滚事务：rollback<span class="token punctuation">(</span><span class="token punctuation">)</span> * 在catch中回滚事务<span class="token number">4</span>. 代码：public class JDBCDemo10 <span class="token punctuation">{</span>    public static void main<span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        Connection conn <span class="token operator">=</span> null<span class="token punctuation">;</span>        PreparedStatement pstmt1 <span class="token operator">=</span> null<span class="token punctuation">;</span>        PreparedStatement pstmt2 <span class="token operator">=</span> null<span class="token punctuation">;</span>        try <span class="token punctuation">{</span>            //1.获取连接            conn <span class="token operator">=</span> JDBCUtils.getConnection<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            //开启事务            conn.setAutoCommit<span class="token punctuation">(</span>false<span class="token punctuation">)</span><span class="token punctuation">;</span>            //2.定义sql            //2.1 张三 - <span class="token number">500</span>            String sql1 <span class="token operator">=</span> <span class="token string">"update account set balance = balance - ? where id = ?"</span><span class="token punctuation">;</span>            //2.2 李四 + <span class="token number">500</span>            String sql2 <span class="token operator">=</span> <span class="token string">"update account set balance = balance + ? where id = ?"</span><span class="token punctuation">;</span>            //3.获取执行sql对象            pstmt1 <span class="token operator">=</span> conn.prepareStatement<span class="token punctuation">(</span>sql1<span class="token punctuation">)</span><span class="token punctuation">;</span>            pstmt2 <span class="token operator">=</span> conn.prepareStatement<span class="token punctuation">(</span>sql2<span class="token punctuation">)</span><span class="token punctuation">;</span>            //4. 设置参数            pstmt1.setDouble<span class="token punctuation">(</span><span class="token number">1,500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            pstmt1.setInt<span class="token punctuation">(</span><span class="token number">2,1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            pstmt2.setDouble<span class="token punctuation">(</span><span class="token number">1,500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            pstmt2.setInt<span class="token punctuation">(</span><span class="token number">2,2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            //5.执行sql            pstmt1.executeUpdate<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            // 手动制造异常            int i <span class="token operator">=</span> <span class="token number">3</span>/0<span class="token punctuation">;</span>            pstmt2.executeUpdate<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            //提交事务            conn.commit<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> catch <span class="token punctuation">(</span>Exception e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            //事务回滚            try <span class="token punctuation">{</span>                if<span class="token punctuation">(</span>conn <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>                    conn.rollback<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span> catch <span class="token punctuation">(</span>SQLException e1<span class="token punctuation">)</span> <span class="token punctuation">{</span>                e1.printStackTrace<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            e.printStackTrace<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>finally <span class="token punctuation">{</span>            JDBCUtils.close<span class="token punctuation">(</span>pstmt1,conn<span class="token punctuation">)</span><span class="token punctuation">;</span>            JDBCUtils.close<span class="token punctuation">(</span>pstmt2,null<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="数据库连接池"><a href="#数据库连接池" class="headerlink" title="数据库连接池"></a>数据库连接池</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">1</span>. 概念：其实就是一个容器<span class="token punctuation">(</span>集合<span class="token punctuation">)</span>，存放数据库连接的容器。    当系统初始化好后，容器被创建，容器中会申请一些连接对象，当用户来访问数据库时，从容器中获取连接对象，用户访问完之后，会将连接对象归还给容器。<span class="token number">2</span>. 好处：<span class="token number">1</span>. 节约资源<span class="token number">2</span>. 用户访问高效<span class="token number">3</span>. 实现：<span class="token number">1</span>. 标准接口：DataSource   javax.sql包下的<span class="token number">1</span>. 方法：* 获取连接：getConnection<span class="token punctuation">(</span><span class="token punctuation">)</span>* 归还连接：Connection.close<span class="token punctuation">(</span><span class="token punctuation">)</span>。如果连接对象Connection是从连接池中获取的，那么调用Connection.close<span class="token punctuation">(</span><span class="token punctuation">)</span>方法，则不会再关闭连接了。而是归还连接<span class="token number">2</span>. 一般我们不去实现它，有数据库厂商来实现<span class="token number">1</span>. C3P0：数据库连接池技术<span class="token number">2</span>. Druid：数据库连接池实现技术，由阿里巴巴提供的<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">4</span>. C3P0：数据库连接池技术* 步骤：<span class="token number">1</span>. 导入jar包 <span class="token punctuation">(</span>两个<span class="token punctuation">)</span> c3p0-0.9.5.2.jar mchange-commons-java-0.2.12.jar ，* 不要忘记导入数据库驱动jar包<span class="token number">2</span>. 定义配置文件：* 名称： c3p0.properties 或者 c3p0-config.xml* 路径：直接将文件放在src目录下即可。<span class="token number">3</span>. 创建核心对象 数据库连接池对象 ComboPooledDataSource<span class="token number">4</span>. 获取连接： getConnection* 代码： //1.创建数据库连接池对象        DataSource ds  <span class="token operator">=</span> new ComboPooledDataSource<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        //2. 获取连接对象        Connection conn <span class="token operator">=</span> ds.getConnection<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token number">5</span>. Druid：数据库连接池实现技术，由阿里巴巴提供的<span class="token number">1</span>. 步骤：<span class="token number">1</span>. 导入jar包 druid-1.0.9.jar<span class="token number">2</span>. 定义配置文件：* 是properties形式的* 可以叫任意名称，可以放在任意目录下<span class="token number">3</span>. 加载配置文件。Properties<span class="token number">4</span>. 获取数据库连接池对象：通过工厂来来获取  DruidDataSourceFactory<span class="token number">5</span>. 获取连接：getConnection* 代码： //3.加载配置文件        Properties pro <span class="token operator">=</span> new Properties<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        InputStream is <span class="token operator">=</span> DruidDemo.class.getClassLoader<span class="token punctuation">(</span><span class="token punctuation">)</span>.getResourceAsStream<span class="token punctuation">(</span><span class="token string">"druid.properties"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        pro.load<span class="token punctuation">(</span>is<span class="token punctuation">)</span><span class="token punctuation">;</span>        //4.获取连接池对象        DataSource ds <span class="token operator">=</span> DruidDataSourceFactory.createDataSource<span class="token punctuation">(</span>pro<span class="token punctuation">)</span><span class="token punctuation">;</span>        //5.获取连接        Connection conn <span class="token operator">=</span> ds.getConnection<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token number">2</span>. 定义工具类<span class="token number">1</span>. 定义一个类 JDBCUtils<span class="token number">2</span>. 提供静态代码块加载配置文件，初始化连接池对象<span class="token number">3</span>. 提供方法<span class="token number">1</span>. 获取连接方法：通过数据库连接池获取连接<span class="token number">2</span>. 释放资源<span class="token number">3</span>. 获取连接池的方法<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">* 代码：public class JDBCUtils <span class="token punctuation">{</span>    //1.定义成员变量 DataSource    private static DataSource ds <span class="token punctuation">;</span>    static<span class="token punctuation">{</span>        try <span class="token punctuation">{</span>            //1.加载配置文件            Properties pro <span class="token operator">=</span> new Properties<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            pro.load<span class="token punctuation">(</span>JDBCUtils.class.getClassLoader<span class="token punctuation">(</span><span class="token punctuation">)</span>.getResourceAsStream<span class="token punctuation">(</span><span class="token string">"druid.properties"</span><span class="token punctuation">))</span><span class="token punctuation">;</span>            //2.获取DataSource            ds <span class="token operator">=</span> DruidDataSourceFactory.createDataSource<span class="token punctuation">(</span>pro<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> catch <span class="token punctuation">(</span>IOException e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            e.printStackTrace<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> catch <span class="token punctuation">(</span>Exception e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            e.printStackTrace<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    /**     * 获取连接     */    public static Connection getConnection<span class="token punctuation">(</span><span class="token punctuation">)</span> throws SQLException <span class="token punctuation">{</span>        <span class="token builtin class-name">return</span> ds.getConnection<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    /**     * 释放资源     */    public static void close<span class="token punctuation">(</span>Statement stmt,Connection conn<span class="token punctuation">)</span><span class="token punctuation">{</span>       /* if<span class="token punctuation">(</span>stmt <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>            try <span class="token punctuation">{</span>                stmt.close<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> catch <span class="token punctuation">(</span>SQLException e<span class="token punctuation">)</span> <span class="token punctuation">{</span>                e.printStackTrace<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        if<span class="token punctuation">(</span>conn <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>            try <span class="token punctuation">{</span>                conn.close<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>//归还连接            <span class="token punctuation">}</span> catch <span class="token punctuation">(</span>SQLException e<span class="token punctuation">)</span> <span class="token punctuation">{</span>                e.printStackTrace<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>*/       close<span class="token punctuation">(</span>null,stmt,conn<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    public static void close<span class="token punctuation">(</span>ResultSet rs , Statement stmt, Connection conn<span class="token punctuation">)</span><span class="token punctuation">{</span>                                  if<span class="token punctuation">(</span>rs <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>            try <span class="token punctuation">{</span>                rs.close<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> catch <span class="token punctuation">(</span>SQLException e<span class="token punctuation">)</span> <span class="token punctuation">{</span>                e.printStackTrace<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>         if<span class="token punctuation">(</span>stmt <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>            try <span class="token punctuation">{</span>                stmt.close<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> catch <span class="token punctuation">(</span>SQLException e<span class="token punctuation">)</span> <span class="token punctuation">{</span>                e.printStackTrace<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        if<span class="token punctuation">(</span>conn <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>            try <span class="token punctuation">{</span>                conn.close<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>//归还连接            <span class="token punctuation">}</span> catch <span class="token punctuation">(</span>SQLException e<span class="token punctuation">)</span> <span class="token punctuation">{</span>                e.printStackTrace<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    /**     * 获取连接池方法     */    public static DataSource <span class="token function-name function">getDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token builtin class-name">return</span>  ds<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span>            <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>​            </p><h4 id="Spring-JDBC"><a href="#Spring-JDBC" class="headerlink" title="Spring JDBC"></a>Spring JDBC</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">* Spring框架对JDBC的简单封装。提供了一个JDBCTemplate对象简化JDBC的开发* 步骤：<span class="token number">1</span>. 导入jar包<span class="token number">2</span>. 创建JdbcTemplate对象。依赖于数据源DataSource* JdbcTemplate template <span class="token operator">=</span> new JdbcTemplate<span class="token punctuation">(</span>ds<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token number">3</span>. 调用JdbcTemplate的方法来完成CRUD的操作* update<span class="token punctuation">(</span><span class="token punctuation">)</span>:执行DML语句。增、删、改语句* queryForMap<span class="token punctuation">(</span><span class="token punctuation">)</span>:查询结果将结果集封装为map集合，将列名作为key，将值作为value 将这条记录封装为一个map集合* 注意：这个方法查询的结果集长度只能是1* queryForList<span class="token punctuation">(</span><span class="token punctuation">)</span>:查询结果将结果集封装为list集合* 注意：将每一条记录封装为一个Map集合，再将Map集合装载到List集合中* query<span class="token punctuation">(</span><span class="token punctuation">)</span>:查询结果，将结果封装为JavaBean对象* query的参数：RowMapper* 一般我们使用BeanPropertyRowMapper实现类。可以完成数据到JavaBean的自动封装* new BeanPropertyRowMapper<span class="token operator">&lt;</span>类型<span class="token operator">&gt;</span><span class="token punctuation">(</span>类型.class<span class="token punctuation">)</span>* queryForObject：查询结果，将结果封装为对象* 一般用于聚合函数的查询<span class="token number">4</span>. 练习：* 需求：<span class="token number">1</span>. 修改1号数据的 salary 为 <span class="token number">10000</span><span class="token number">2</span>. 添加一条记录<span class="token number">3</span>. 删除刚才添加的记录<span class="token number">4</span>. 查询id为1的记录，将其封装为Map集合<span class="token number">5</span>. 查询所有记录，将其封装为List<span class="token number">6</span>. 查询所有记录，将其封装为Emp对象的List集合<span class="token number">7</span>. 查询总记录数* 代码：<span class="token function">import</span> cn.itcast.domain.Emp<span class="token punctuation">;</span><span class="token function">import</span> cn.itcast.utils.JDBCUtils<span class="token punctuation">;</span><span class="token function">import</span> org.junit.Test<span class="token punctuation">;</span><span class="token function">import</span> org.springframework.jdbc.core.BeanPropertyRowMapper<span class="token punctuation">;</span><span class="token function">import</span> org.springframework.jdbc.core.JdbcTemplate<span class="token punctuation">;</span><span class="token function">import</span> org.springframework.jdbc.core.RowMapper<span class="token punctuation">;</span><span class="token function">import</span> java.sql.Date<span class="token punctuation">;</span><span class="token function">import</span> java.sql.ResultSet<span class="token punctuation">;</span><span class="token function">import</span> java.sql.SQLException<span class="token punctuation">;</span><span class="token function">import</span> java.util.List<span class="token punctuation">;</span><span class="token function">import</span> java.util.Map<span class="token punctuation">;</span>public class JdbcTemplateDemo2 <span class="token punctuation">{</span>    //Junit单元测试，可以让方法独立执行       //1. 获取JDBCTemplate对象    private JdbcTemplate template <span class="token operator">=</span> new JdbcTemplate<span class="token punctuation">(</span>JDBCUtils.getDataSource<span class="token punctuation">(</span><span class="token punctuation">))</span><span class="token punctuation">;</span>    /**     * <span class="token number">1</span>. 修改1号数据的 salary 为 <span class="token number">10000</span>     */    @Test    public void <span class="token function-name function">test1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>   <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">          //2. 定义sql    String sql <span class="token operator">=</span> <span class="token string">"update emp set salary = 10000 where id = 1001"</span><span class="token punctuation">;</span>    //3. 执行sql    int count <span class="token operator">=</span> template.update<span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>    System.out.println<span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>/** * <span class="token number">2</span>. 添加一条记录 */@Testpublic void <span class="token function-name function">test2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    String sql <span class="token operator">=</span> <span class="token string">"insert into emp(id,ename,dept_id) values(?,?,?)"</span><span class="token punctuation">;</span>    int count <span class="token operator">=</span> template.update<span class="token punctuation">(</span>sql, <span class="token number">1015</span>, <span class="token string">"郭靖"</span>, <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    System.out.println<span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>/** * <span class="token number">3</span>.删除刚才添加的记录 */@Testpublic void <span class="token function-name function">test3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    String sql <span class="token operator">=</span> <span class="token string">"delete from emp where id = ?"</span><span class="token punctuation">;</span>    int count <span class="token operator">=</span> template.update<span class="token punctuation">(</span>sql, <span class="token number">1015</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    System.out.println<span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>/** * <span class="token number">4</span>.查询id为1001的记录，将其封装为Map集合 * 注意：这个方法查询的结果集长度只能是1 */@Testpublic void <span class="token function-name function">test4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    String sql <span class="token operator">=</span> <span class="token string">"select * from emp where id = ? or id = ?"</span><span class="token punctuation">;</span>    Map<span class="token operator">&lt;</span>String, Object<span class="token operator">&gt;</span> map <span class="token operator">=</span> template.queryForMap<span class="token punctuation">(</span>sql, <span class="token number">1001,1002</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    System.out.println<span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span>    //<span class="token punctuation">{</span>id<span class="token operator">=</span><span class="token number">1001</span>, <span class="token assign-left variable">ename</span><span class="token operator">=</span>孙悟空, <span class="token assign-left variable">job_id</span><span class="token operator">=</span><span class="token number">4</span>, <span class="token assign-left variable">mgr</span><span class="token operator">=</span><span class="token number">1004</span>, <span class="token assign-left variable">joindate</span><span class="token operator">=</span><span class="token number">2000</span>-12-17, <span class="token assign-left variable">salary</span><span class="token operator">=</span><span class="token number">10000.00</span>, <span class="token assign-left variable">bonus</span><span class="token operator">=</span>null, <span class="token assign-left variable">dept_id</span><span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">}</span><span class="token punctuation">}</span>/** * <span class="token number">5</span>. 查询所有记录，将其封装为List */@Testpublic void <span class="token function-name function">test5</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    String sql <span class="token operator">=</span> <span class="token string">"select * from emp"</span><span class="token punctuation">;</span>    List<span class="token operator">&lt;</span>Map<span class="token operator">&lt;</span>String, Object<span class="token operator">&gt;&gt;</span> list <span class="token operator">=</span> template.queryForList<span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>Map<span class="token operator">&lt;</span>String, Object<span class="token operator">&gt;</span> stringObjectMap <span class="token builtin class-name">:</span> list<span class="token punctuation">)</span> <span class="token punctuation">{</span>        System.out.println<span class="token punctuation">(</span>stringObjectMap<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span>/** * <span class="token number">6</span>. 查询所有记录，将其封装为Emp对象的List集合 */@Testpublic void <span class="token function-name function">test6</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    String sql <span class="token operator">=</span> <span class="token string">"select * from emp"</span><span class="token punctuation">;</span>    List<span class="token operator">&lt;</span>Emp<span class="token operator">&gt;</span> list <span class="token operator">=</span> template.query<span class="token punctuation">(</span>sql, new RowMapper<span class="token operator">&lt;</span>Emp<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        @Override        public Emp mapRow<span class="token punctuation">(</span>ResultSet rs, int i<span class="token punctuation">)</span> throws SQLException <span class="token punctuation">{</span>            Emp emp <span class="token operator">=</span> new Emp<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            int <span class="token function">id</span> <span class="token operator">=</span> rs.getInt<span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            String ename <span class="token operator">=</span> rs.getString<span class="token punctuation">(</span><span class="token string">"ename"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            int job_id <span class="token operator">=</span> rs.getInt<span class="token punctuation">(</span><span class="token string">"job_id"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            int mgr <span class="token operator">=</span> rs.getInt<span class="token punctuation">(</span><span class="token string">"mgr"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            Date joindate <span class="token operator">=</span> rs.getDate<span class="token punctuation">(</span><span class="token string">"joindate"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            double salary <span class="token operator">=</span> rs.getDouble<span class="token punctuation">(</span><span class="token string">"salary"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            double bonus <span class="token operator">=</span> rs.getDouble<span class="token punctuation">(</span><span class="token string">"bonus"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            int dept_id <span class="token operator">=</span> rs.getInt<span class="token punctuation">(</span><span class="token string">"dept_id"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            emp.setId<span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>            emp.setEname<span class="token punctuation">(</span>ename<span class="token punctuation">)</span><span class="token punctuation">;</span>            emp.setJob_id<span class="token punctuation">(</span>job_id<span class="token punctuation">)</span><span class="token punctuation">;</span>            emp.setMgr<span class="token punctuation">(</span>mgr<span class="token punctuation">)</span><span class="token punctuation">;</span>            emp.setJoindate<span class="token punctuation">(</span>joindate<span class="token punctuation">)</span><span class="token punctuation">;</span>            emp.setSalary<span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">;</span>            emp.setBonus<span class="token punctuation">(</span>bonus<span class="token punctuation">)</span><span class="token punctuation">;</span>            emp.setDept_id<span class="token punctuation">(</span>dept_id<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token builtin class-name">return</span> emp<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>​                </p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">        <span class="token keyword">for</span> <span class="token punctuation">(</span>Emp emp <span class="token builtin class-name">:</span> list<span class="token punctuation">)</span> <span class="token punctuation">{</span>            System.out.println<span class="token punctuation">(</span>emp<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    /**     * <span class="token number">6</span>. 查询所有记录，将其封装为Emp对象的List集合     */    @Test    public void <span class="token function-name function">test6_2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        String sql <span class="token operator">=</span> <span class="token string">"select * from emp"</span><span class="token punctuation">;</span>        List<span class="token operator">&lt;</span>Emp<span class="token operator">&gt;</span> list <span class="token operator">=</span> template.query<span class="token punctuation">(</span>sql, new BeanPropertyRowMapper<span class="token operator">&lt;</span>Emp<span class="token operator">&gt;</span><span class="token punctuation">(</span>Emp.class<span class="token punctuation">))</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>Emp emp <span class="token builtin class-name">:</span> list<span class="token punctuation">)</span> <span class="token punctuation">{</span>            System.out.println<span class="token punctuation">(</span>emp<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    /**     * <span class="token number">7</span>. 查询总记录数     */    @Test    public void <span class="token function-name function">test7</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        String sql <span class="token operator">=</span> <span class="token string">"select count(id) from emp"</span><span class="token punctuation">;</span>        Long total <span class="token operator">=</span> template.queryForObject<span class="token punctuation">(</span>sql, Long.class<span class="token punctuation">)</span><span class="token punctuation">;</span>        System.out.println<span class="token punctuation">(</span>total<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> 数据库篇 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> mysql </tag>
            
            <tag> java </tag>
            
            <tag> idea </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>数据库加控制台简单学生管理系统</title>
      <link href="posts/e3e08109.html"/>
      <url>posts/e3e08109.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>首先建学生表</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">create table student<span class="token punctuation">(</span>    <span class="token function">id</span>      int<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> auto_increment        primary key,    stuid  varchar<span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span>    null,    stuname varchar<span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span>    null,    <span class="token builtin class-name">pwd</span>    varchar<span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span>    null,    math    int default <span class="token string">'0'</span> null,    eng    int default <span class="token string">'0'</span> null,    java    int default <span class="token string">'0'</span> null,    class  int default <span class="token string">'0'</span> null<span class="token punctuation">)</span>    charset <span class="token operator">=</span> utf8<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>然后建老师表</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">create table teacher<span class="token punctuation">(</span>    <span class="token function">id</span>        int<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> auto_increment        primary key,    teacherid varchar<span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span>    null,    <span class="token builtin class-name">pwd</span>      varchar<span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span>    null,    class    int default <span class="token string">'0'</span> null<span class="token punctuation">)</span>    charset <span class="token operator">=</span> utf8<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> java篇 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> mysql </tag>
            
            <tag> IDEA </tag>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
